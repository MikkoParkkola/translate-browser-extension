<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>TRANSLATE! by Mikko</title>
  <link rel="stylesheet" href="styles/design-system.css">
  <link rel="stylesheet" href="styles/popup.css">
</head>
<body class="popup-body" data-theme="light">
  <!-- Loading Overlay -->
  <div id="loading-overlay" class="loading-overlay" style="display: none;" aria-live="polite" role="status">
    <div class="loading-content">
      <div class="loading-spinner" aria-hidden="true"></div>
      <div class="loading-text">Translating...</div>
    </div>
  </div>

  <div class="popup-container">
    <!-- Header -->
    <header class="popup-header">
      <div class="header-brand">
        <div class="brand-icon">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
            <path d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.01-4.65.7-6.88l-.46.87-.1.04-1.17 2.18-1.17-2.18-.1-.04-.46-.87c-1.31 2.23-1.04 4.94.7 6.88l.03.03-2.54 2.51c-.83-.09-1.48-.85-1.48-1.77 0-.98.8-1.77 1.77-1.77.98 0 1.77.8 1.77 1.77 0 .92-.65 1.68-1.48 1.77z" stroke="currentColor" stroke-width="2"/>
          </svg>
        </div>
        <div class="brand-text">
          <h1 class="brand-title">
            <span id="productName">TRANSLATE!</span>
            <span id="productAuthor" class="brand-author">by Mikko</span>
          </h1>
        </div>
        <button id="settings-button" class="settings-link" aria-label="Settings">
          <svg width="14" height="14" viewBox="0 0 24 24" fill="none">
            <circle cx="12" cy="12" r="3" stroke="currentColor" stroke-width="2"/>
            <path d="M19.4 15a1.65 1.65 0 00.33 1.82l.06.06a2 2 0 010 2.83 2 2 0 01-2.83 0l-.06-.06a1.65 1.65 0 00-1.82-.33 1.65 1.65 0 00-1 1.51V21a2 2 0 01-2 2 2 2 0 01-2-2v-.09A1.65 1.65 0 009 19.4a1.65 1.65 0 00-1.82.33l-.06.06a2 2 0 01-2.83 0 2 2 0 010-2.83l.06-.06a1.65 1.65 0 00.33-1.82 1.65 1.65 0 00-1.51-1H3a2 2 0 01-2-2 2 2 0 012-2h.09A1.65 1.65 0 004.6 9a1.65 1.65 0 00-.33-1.82l-.06-.06a2 2 0 010-2.83 2 2 0 012.83 0l.06.06a1.65 1.65 0 001.82.33H9a1.65 1.65 0 001-1.51V3a2 2 0 012-2 2 2 0 012 2v.09a1.65 1.65 0 001 1.51h.09a1.65 1.65 0 001.82-.33l.06-.06a2 2 0 012.83 0 2 2 0 010 2.83l-.06.06a1.65 1.65 0 00-.33 1.82V9a1.65 1.65 0 001.51 1H21a2 2 0 012 2 2 2 0 01-2 2h-.09a1.65 1.65 0 00-1.51 1z" stroke="currentColor" stroke-width="2"/>
          </svg>
        </button>
      </div>

      <!-- Provider Status -->
      <div class="provider-status">
        <div class="provider-info">
          <span id="current-provider" class="provider-name">Local Model (Hunyuan-MT-7B)</span>
          <span id="provider-status" class="status-indicator">üü¢ Ready</span>
        </div>
      </div>
    </header>

    <main class="popup-main">
      <!-- Language Selection -->
      <section class="language-section">
        <div class="language-inputs">
          <div class="language-group">
            <div class="select-wrapper">
              <select id="source-language" class="language-select" aria-label="Source language">
                <option value="auto">üåç Auto Detect</option>
              </select>
              <svg class="select-arrow" width="12" height="12" viewBox="0 0 24 24" fill="none">
                <path d="M6 9l6 6 6-6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
            </div>
          </div>

          <div class="language-swap">
            <button id="swap-languages" class="swap-button" aria-label="Swap languages">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                <path d="M17 17H7l4 4m-4-14h10l-4-4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
            </button>
          </div>

          <div class="language-group">
            <div class="select-wrapper">
              <select id="target-language" class="language-select" aria-label="Target language">
                <option value="en">üá∫üá∏ English</option>
              </select>
              <svg class="select-arrow" width="12" height="12" viewBox="0 0 24 24" fill="none">
                <path d="M6 9l6 6 6-6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
            </div>
          </div>
        </div>
      </section>

      <!-- Strategy Selection -->
      <section class="strategy-section">
        <div class="strategy-buttons">
          <button id="strategy-smart" class="strategy-button active" data-strategy="smart" title="Intelligent provider selection">Smart</button>
          <button id="strategy-fast" class="strategy-button" data-strategy="fast" title="Optimize for speed">Fast</button>
          <button id="strategy-quality" class="strategy-button" data-strategy="quality" title="Optimize for quality">Quality</button>
        </div>
      </section>

      <!-- Provider Selection -->
      <section class="provider-section">
        <div class="provider-field">
          <label for="provider-select" class="provider-label">Provider</label>
          <div class="select-wrapper">
            <select id="provider-select" class="provider-select" aria-label="Translation provider"></select>
            <svg class="select-arrow" width="12" height="12" viewBox="0 0 24 24" fill="none">
              <path d="M6 9l6 6 6-6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </div>
          <p id="provider-hint" class="provider-hint">Public Google Translate (no API key required).</p>
        </div>

        <div id="api-key-group" class="api-key-group" style="display: none;">
          <div class="api-key-header">
            <label for="api-key-input" class="provider-label">API key</label>
            <button type="button" id="toggle-api-key" class="api-key-toggle" aria-label="Show API key">Show</button>
          </div>
          <div class="api-key-row">
            <input type="password" id="api-key-input" class="api-key-input" placeholder="Enter API key" autocomplete="off" spellcheck="false">
            <button type="button" id="save-api-key" class="api-key-save">Save</button>
          </div>
          <p id="api-key-hint" class="api-key-hint">Stored securely in Chrome sync storage.</p>
        </div>
      </section>

      <!-- Auto Translate Toggle -->
      <section class="auto-translate-section">
        <div class="toggle-row">
          <div class="toggle-label">
            <span class="toggle-title">üîò Auto-translate this page</span>
          </div>
          <label class="toggle-switch">
            <input type="checkbox" id="auto-translate-toggle">
            <span class="toggle-slider"></span>
          </label>
        </div>
      </section>

      <!-- Action Buttons -->
      <section class="action-section">
        <button id="translate-button" class="action-button action-button--primary">
          <span class="button-icon" aria-hidden="true">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
              <path d="M12 2l3.09 6.26L22 9l-5 4.87L18.18 22 12 18.77 5.82 22 7 13.87 2 9l6.91-.74L12 2z" stroke="currentColor" stroke-width="2" fill="none"/>
            </svg>
          </span>
          <span class="button-text">Translate Selection</span>
          <span class="button-loading" aria-hidden="true"></span>
          <span class="progress-bar-mini" aria-hidden="true"></span>
        </button>

        <button id="translate-page-button" class="action-button action-button--secondary">
          <svg class="action-icon" width="18" height="18" viewBox="0 0 24 24" fill="none">
            <path d="M4 6h16M4 10h16M4 14h16M4 18h16" stroke="currentColor" stroke-width="2"/>
          </svg>
          üåê Translate Page
        </button>
      </section>

      <!-- Usage Tracking -->
      <section class="usage-section">
        <div class="usage-header">
          <span class="usage-title">üìä Today:</span>
          <span id="usage-summary" class="usage-summary">15/100 req, 2.3k/50k chars</span>
        </div>
        <div class="usage-bars">
          <div class="usage-bar">
            <div class="usage-bar-track">
              <div id="requests-bar" class="usage-bar-fill" style="width: 15%;"></div>
            </div>
          </div>
          <div class="usage-bar">
            <div class="usage-bar-track">
              <div id="chars-bar" class="usage-bar-fill" style="width: 5%;"></div>
            </div>
          </div>
        </div>
        <div class="cost-monitor">
          <span class="cost-label">üí∞ Cost: <span id="cost-today">$0.08</span></span>
          <span class="budget-label">(Budget: <span id="budget-monthly">$2.00</span>/month)</span>
        </div>
      </section>
    </main>
  </div>

  <!-- Toast Container -->
  <div id="toast-container" class="toast-container" aria-live="polite" aria-atomic="true"></div>

  <!-- Error Toast -->
  <div id="error-toast" class="error-toast" style="display: none;" role="alert">
    <div class="error-content">
      <span id="error-message" class="error-text">Translation failed</span>
      <button id="error-close" class="error-close" aria-label="Close">‚úï</button>
    </div>
  </div>

  <!-- Load Core Dependencies -->
  <script src="popup-simple.js"></script>
</body>
</html>
