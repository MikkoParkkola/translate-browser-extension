{"version":3,"file":"popup-Dcq1-GUt.js","sources":["../../src/popup/components/ProviderStatus.tsx","../../src/popup/components/ModelSelector.tsx","../../src/popup/components/LanguageSelector.tsx","../../src/popup/components/StrategySelector.tsx","../../src/popup/components/ModelStatus.tsx","../../src/popup/App.tsx","../../src/popup/index.tsx"],"sourcesContent":["import { Component } from 'solid-js';\n\ninterface Props {\n  name: string;\n  status: 'ready' | 'loading' | 'error';\n}\n\nexport const ProviderStatus: Component<Props> = (props) => {\n  const statusIndicator = () => {\n    switch (props.status) {\n      case 'ready':\n        return { icon: '', text: 'Ready', class: 'status--ready' };\n      case 'loading':\n        return { icon: '', text: 'Loading...', class: 'status--loading' };\n      case 'error':\n        return { icon: '', text: 'Error', class: 'status--error' };\n    }\n  };\n\n  return (\n    <div class=\"provider-status\">\n      <div class=\"provider-info\">\n        <span class=\"provider-name\">{props.name}</span>\n        <span class={`status-indicator ${statusIndicator().class}`}>\n          <span class=\"status-icon\">{statusIndicator().icon}</span>\n          <span class=\"status-text\">{statusIndicator().text}</span>\n        </span>\n      </div>\n    </div>\n  );\n};\n","import { Component, Show, createSignal, onMount, For } from 'solid-js';\nimport type { TranslationProviderId } from '../../types';\n\nexport interface ModelInfo {\n  id: TranslationProviderId;\n  name: string;\n  tag: string;\n  description: string;\n  size: string;\n  isCloud?: boolean;\n  costEstimate?: string;\n}\n\nexport interface ModelDownloadStatus {\n  isDownloading: boolean;\n  progress: number;\n  isDownloaded: boolean;\n  error: string | null;\n}\n\nexport interface CloudProviderStatus {\n  configured: boolean;\n  usage?: {\n    tokens: number;\n    cost: number;\n    limitReached?: boolean;\n  };\n}\n\ninterface Props {\n  selected: TranslationProviderId;\n  onChange: (provider: TranslationProviderId) => void;\n  downloadStatus?: Record<TranslationProviderId, ModelDownloadStatus>;\n  cloudStatus?: Record<string, CloudProviderStatus>;\n}\n\n// Local models (no API key required)\nexport const LOCAL_MODELS: ModelInfo[] = [\n  {\n    id: 'opus-mt',\n    name: 'OPUS-MT',\n    tag: 'Fast',\n    description: 'Helsinki-NLP',\n    size: '~170MB',\n  },\n  {\n    id: 'translategemma',\n    name: 'TranslateGemma',\n    tag: 'Quality',\n    description: 'Google 4B',\n    size: '~3.6GB',\n  },\n  {\n    id: 'chrome-builtin',\n    name: 'Chrome Built-in',\n    tag: 'Native',\n    description: 'Chrome 138+',\n    size: 'Built-in',\n  },\n];\n\n// Cloud providers (API key required)\nexport const CLOUD_PROVIDERS: ModelInfo[] = [\n  {\n    id: 'deepl',\n    name: 'DeepL',\n    tag: 'Premium',\n    description: 'Best quality',\n    size: 'API',\n    isCloud: true,\n    costEstimate: '~$20/1M chars',\n  },\n  {\n    id: 'openai',\n    name: 'OpenAI',\n    tag: 'GPT-4',\n    description: 'AI translation',\n    size: 'API',\n    isCloud: true,\n    costEstimate: '~$5/1M tokens',\n  },\n  {\n    id: 'anthropic',\n    name: 'Claude',\n    tag: 'AI',\n    description: 'Anthropic',\n    size: 'API',\n    isCloud: true,\n    costEstimate: '~$3/1M tokens',\n  },\n  {\n    id: 'google-cloud',\n    name: 'Google',\n    tag: 'Cloud',\n    description: 'Google Cloud',\n    size: 'API',\n    isCloud: true,\n    costEstimate: '~$20/1M chars',\n  },\n];\n\nexport const MODELS: ModelInfo[] = [...LOCAL_MODELS, ...CLOUD_PROVIDERS];\n\n/**\n * Compact dropdown model selector\n */\nexport const ModelSelector: Component<Props> = (props) => {\n  const [cloudApiStatus, setCloudApiStatus] = createSignal<Record<string, boolean>>({});\n  const [isOpen, setIsOpen] = createSignal(false);\n\n  onMount(async () => {\n    try {\n      const response = await chrome.runtime.sendMessage({ type: 'getCloudProviderStatus' });\n      if (response?.status) {\n        setCloudApiStatus(response.status);\n      }\n    } catch {\n      // Ignore\n    }\n  });\n\n  const getStatus = (modelId: TranslationProviderId): ModelDownloadStatus => {\n    return props.downloadStatus?.[modelId] ?? {\n      isDownloading: false,\n      progress: 0,\n      isDownloaded: false,\n      error: null,\n    };\n  };\n\n  const isCloudConfigured = (modelId: TranslationProviderId): boolean => {\n    return cloudApiStatus()[modelId] ?? false;\n  };\n\n  const selectedModel = () => MODELS.find(m => m.id === props.selected) || LOCAL_MODELS[0];\n\n  const handleSelect = (modelId: TranslationProviderId) => {\n    const model = MODELS.find(m => m.id === modelId);\n    if (model?.isCloud && !isCloudConfigured(modelId)) {\n      chrome.runtime.openOptionsPage();\n    } else {\n      props.onChange(modelId);\n    }\n    setIsOpen(false);\n  };\n\n  const getStatusIcon = (model: ModelInfo) => {\n    const status = getStatus(model.id);\n    if (status.isDownloading) return '‚è≥';\n    if (status.error) return '‚ö†Ô∏è';\n    if (model.isCloud) {\n      return isCloudConfigured(model.id) ? '‚úì' : 'üîë';\n    }\n    if (status.isDownloaded) return '‚úì';\n    return '';\n  };\n\n  return (\n    <section class=\"model-dropdown-section\">\n      <div class=\"model-dropdown-wrapper\">\n        <button\n          class=\"model-dropdown-trigger\"\n          onClick={() => setIsOpen(!isOpen())}\n          aria-expanded={isOpen()}\n          aria-haspopup=\"listbox\"\n        >\n          <div class=\"model-dropdown-selected\">\n            <span class=\"model-dropdown-name\">{selectedModel().name}</span>\n            <span class=\"model-dropdown-tag\">{selectedModel().tag}</span>\n          </div>\n          <svg class=\"model-dropdown-arrow\" width=\"12\" height=\"12\" viewBox=\"0 0 24 24\" fill=\"none\">\n            <path d=\"M6 9l6 6 6-6\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"/>\n          </svg>\n        </button>\n\n        <Show when={isOpen()}>\n          <div class=\"model-dropdown-menu\" role=\"listbox\">\n            <div class=\"model-dropdown-group\">\n              <div class=\"model-dropdown-group-label\">Local Models</div>\n              <For each={LOCAL_MODELS}>\n                {(model) => (\n                  <button\n                    class={`model-dropdown-item ${props.selected === model.id ? 'active' : ''}`}\n                    onClick={() => handleSelect(model.id)}\n                    role=\"option\"\n                    aria-selected={props.selected === model.id}\n                  >\n                    <span class=\"model-dropdown-item-name\">{model.name}</span>\n                    <span class=\"model-dropdown-item-meta\">\n                      <span class=\"model-dropdown-item-tag\">{model.tag}</span>\n                      <span class=\"model-dropdown-item-size\">{model.size}</span>\n                      <span class=\"model-dropdown-item-status\">{getStatusIcon(model)}</span>\n                    </span>\n                  </button>\n                )}\n              </For>\n            </div>\n\n            <div class=\"model-dropdown-group\">\n              <div class=\"model-dropdown-group-label\">\n                Cloud Providers\n                <button\n                  class=\"model-dropdown-configure\"\n                  onClick={(e) => {\n                    e.stopPropagation();\n                    chrome.runtime.openOptionsPage();\n                  }}\n                >\n                  Configure\n                </button>\n              </div>\n              <For each={CLOUD_PROVIDERS}>\n                {(model) => (\n                  <button\n                    class={`model-dropdown-item ${props.selected === model.id ? 'active' : ''} ${!isCloudConfigured(model.id) ? 'unconfigured' : ''}`}\n                    onClick={() => handleSelect(model.id)}\n                    role=\"option\"\n                    aria-selected={props.selected === model.id}\n                  >\n                    <span class=\"model-dropdown-item-name\">{model.name}</span>\n                    <span class=\"model-dropdown-item-meta\">\n                      <span class=\"model-dropdown-item-tag\">{model.tag}</span>\n                      <span class=\"model-dropdown-item-cost\">{model.costEstimate}</span>\n                      <span class=\"model-dropdown-item-status\">{getStatusIcon(model)}</span>\n                    </span>\n                  </button>\n                )}\n              </For>\n            </div>\n          </div>\n        </Show>\n\n        {/* Download progress overlay */}\n        <Show when={getStatus(props.selected).isDownloading}>\n          <div class=\"model-dropdown-progress\">\n            <div\n              class=\"model-dropdown-progress-fill\"\n              style={{ width: `${getStatus(props.selected).progress}%` }}\n            />\n          </div>\n        </Show>\n      </div>\n    </section>\n  );\n};\n\nexport default ModelSelector;\n","import { Component, For } from 'solid-js';\n\ninterface Props {\n  sourceLang: string;\n  targetLang: string;\n  onSourceChange: (lang: string) => void;\n  onTargetChange: (lang: string) => void;\n  onSwap: () => void;\n}\n\nconst LANGUAGES = [\n  { code: 'auto', name: 'Auto Detect', flag: '' },\n  { code: 'en', name: 'English', flag: '' },\n  { code: 'fi', name: 'Finnish', flag: '' },\n  { code: 'de', name: 'German', flag: '' },\n  { code: 'fr', name: 'French', flag: '' },\n  { code: 'es', name: 'Spanish', flag: '' },\n  { code: 'sv', name: 'Swedish', flag: '' },\n  { code: 'ru', name: 'Russian', flag: '' },\n  { code: 'zh', name: 'Chinese', flag: '' },\n  { code: 'ja', name: 'Japanese', flag: '' },\n  { code: 'nl', name: 'Dutch', flag: '' },\n  { code: 'cs', name: 'Czech', flag: '' },\n];\n\nexport const LanguageSelector: Component<Props> = (props) => {\n  return (\n    <section class=\"language-section\">\n      <div class=\"language-inputs\">\n        <div class=\"language-group\">\n          <div class=\"select-wrapper\">\n            <select\n              class=\"language-select\"\n              value={props.sourceLang}\n              onChange={(e) => props.onSourceChange(e.target.value)}\n              aria-label=\"Source language\"\n            >\n              <For each={LANGUAGES}>\n                {(lang) => (\n                  <option value={lang.code}>\n                    {lang.flag} {lang.name}\n                  </option>\n                )}\n              </For>\n            </select>\n            <svg class=\"select-arrow\" width=\"12\" height=\"12\" viewBox=\"0 0 24 24\" fill=\"none\">\n              <path\n                d=\"M6 9l6 6 6-6\"\n                stroke=\"currentColor\"\n                stroke-width=\"2\"\n                stroke-linecap=\"round\"\n                stroke-linejoin=\"round\"\n              />\n            </svg>\n          </div>\n        </div>\n\n        <button class=\"swap-button\" onClick={props.onSwap} aria-label=\"Swap languages\">\n          <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\">\n            <path\n              d=\"M17 17H7l4 4m-4-14h10l-4-4\"\n              stroke=\"currentColor\"\n              stroke-width=\"2\"\n              stroke-linecap=\"round\"\n              stroke-linejoin=\"round\"\n            />\n          </svg>\n        </button>\n\n        <div class=\"language-group\">\n          <div class=\"select-wrapper\">\n            <select\n              class=\"language-select\"\n              value={props.targetLang}\n              onChange={(e) => props.onTargetChange(e.target.value)}\n              aria-label=\"Target language\"\n            >\n              <For each={LANGUAGES.filter((l) => l.code !== 'auto')}>\n                {(lang) => (\n                  <option value={lang.code}>\n                    {lang.flag} {lang.name}\n                  </option>\n                )}\n              </For>\n            </select>\n            <svg class=\"select-arrow\" width=\"12\" height=\"12\" viewBox=\"0 0 24 24\" fill=\"none\">\n              <path\n                d=\"M6 9l6 6 6-6\"\n                stroke=\"currentColor\"\n                stroke-width=\"2\"\n                stroke-linecap=\"round\"\n                stroke-linejoin=\"round\"\n              />\n            </svg>\n          </div>\n        </div>\n      </div>\n    </section>\n  );\n};\n","import { Component, For } from 'solid-js';\nimport type { Strategy } from '../../types';\n\ninterface Props {\n  selected: Strategy;\n  onChange: (strategy: Strategy) => void;\n}\n\nconst STRATEGIES: Array<{ id: Strategy; label: string; title: string }> = [\n  { id: 'smart', label: 'Smart', title: 'Intelligent provider selection' },\n  { id: 'fast', label: 'Fast', title: 'Optimize for speed' },\n  { id: 'quality', label: 'Quality', title: 'Optimize for quality' },\n];\n\nexport const StrategySelector: Component<Props> = (props) => {\n  return (\n    <section class=\"strategy-section\">\n      <div class=\"strategy-buttons\">\n        <For each={STRATEGIES}>\n          {(strategy) => (\n            <button\n              class={`strategy-button ${props.selected === strategy.id ? 'active' : ''}`}\n              data-strategy={strategy.id}\n              title={strategy.title}\n              onClick={() => props.onChange(strategy.id)}\n            >\n              {strategy.label}\n            </button>\n          )}\n        </For>\n      </div>\n    </section>\n  );\n};\n","import { Component, Show } from 'solid-js';\n\ninterface Props {\n  isLoading: boolean;\n  progress: number;\n  isCached: boolean;\n  modelId: string | null;\n  currentFile: string | null;\n}\n\n// Extract short model name from full ID (e.g., \"Xenova/opus-mt-en-fi\" -> \"en-fi\")\nfunction getShortModelName(modelId: string | null): string {\n  if (!modelId) return 'Model';\n  const match = modelId.match(/opus-mt-(.+)$/);\n  return match ? match[1].toUpperCase() : modelId;\n}\n\n// Format file name for display\nfunction getShortFileName(file: string | null): string {\n  if (!file) return '';\n  // Extract just the filename from paths like \"onnx/model.onnx\"\n  const parts = file.split('/');\n  return parts[parts.length - 1];\n}\n\n// Estimate download size for first-time users\nfunction getEstimatedSize(): string {\n  return '~50-100 MB'; // OPUS-MT models are typically in this range\n}\n\nexport const ModelStatus: Component<Props> = (props) => {\n  return (\n    <Show when={props.isLoading || props.isCached}>\n      <div class=\"model-status\">\n        <Show when={props.isLoading}>\n          <div class=\"model-loading\">\n            <div class=\"model-loading-header\">\n              <span class=\"model-loading-icon\">\n                <svg width=\"14\" height=\"14\" viewBox=\"0 0 24 24\" fill=\"none\" class=\"spinning\">\n                  <path\n                    d=\"M12 2v4m0 12v4M4.93 4.93l2.83 2.83m8.48 8.48l2.83 2.83M2 12h4m12 0h4M4.93 19.07l2.83-2.83m8.48-8.48l2.83-2.83\"\n                    stroke=\"currentColor\"\n                    stroke-width=\"2\"\n                    stroke-linecap=\"round\"\n                  />\n                </svg>\n              </span>\n              <span class=\"model-loading-text\">\n                {props.progress < 100\n                  ? `Downloading ${getShortModelName(props.modelId)}...`\n                  : 'Initializing model...'}\n              </span>\n            </div>\n            <div class=\"model-progress-container\">\n              <div class=\"model-progress-bar\">\n                <div\n                  class=\"model-progress-fill\"\n                  style={{ width: `${props.progress}%` }}\n                />\n              </div>\n              <span class=\"model-progress-percent\">{Math.round(props.progress)}%</span>\n            </div>\n            <Show when={props.currentFile}>\n              <div class=\"model-file-info\">\n                {getShortFileName(props.currentFile)}\n              </div>\n            </Show>\n            <Show when={props.progress === 0}>\n              <div class=\"model-first-time\">\n                First-time download: {getEstimatedSize()}\n              </div>\n            </Show>\n          </div>\n        </Show>\n\n        <Show when={!props.isLoading && props.isCached}>\n          <div class=\"model-cached\">\n            <span class=\"model-cached-icon\">\n              <svg width=\"14\" height=\"14\" viewBox=\"0 0 24 24\" fill=\"none\">\n                <path\n                  d=\"M20 6L9 17l-5-5\"\n                  stroke=\"currentColor\"\n                  stroke-width=\"2\"\n                  stroke-linecap=\"round\"\n                  stroke-linejoin=\"round\"\n                />\n              </svg>\n            </span>\n            <span class=\"model-cached-text\">\n              {getShortModelName(props.modelId)} ready\n            </span>\n          </div>\n        </Show>\n      </div>\n    </Show>\n  );\n};\n","import { createSignal, onMount, onCleanup, Show } from 'solid-js';\nimport { ProviderStatus } from './components/ProviderStatus';\nimport { ModelSelector, type ModelDownloadStatus } from './components/ModelSelector';\nimport { LanguageSelector } from './components/LanguageSelector';\nimport { StrategySelector } from './components/StrategySelector';\nimport { ModelStatus } from './components/ModelStatus';\nimport type { Strategy, ModelProgressMessage, TranslationProviderId } from '../types';\nimport { safeStorageGet, safeStorageSet } from '../core/storage';\nimport { browserAPI } from '../core/browser-api';\n\n// Detect browser's preferred language, fallback to 'en'\nconst getBrowserLanguage = () => {\n  const lang = navigator.language?.split('-')[0] || 'en';\n  return lang;\n};\n\nexport default function App() {\n  const [sourceLang, setSourceLangInternal] = createSignal('auto');\n  const [targetLang, setTargetLangInternal] = createSignal(getBrowserLanguage());\n  const [strategy, setStrategyInternal] = createSignal<Strategy>('smart');\n  const [activeProvider, setActiveProvider] = createSignal<TranslationProviderId>('opus-mt');\n  const [providerStatus, setProviderStatus] = createSignal<'ready' | 'loading' | 'error'>('ready');\n\n  const providerName = () => {\n    switch (activeProvider()) {\n      case 'translategemma': return 'TranslateGemma 4B';\n      case 'chrome-builtin': return 'Chrome Built-in';\n      default: return 'Helsinki-NLP OPUS-MT';\n    }\n  };\n  const [isTranslating, setIsTranslating] = createSignal(false);\n  const [autoTranslate, setAutoTranslate] = createSignal(false);\n  const [bilingualMode, setBilingualMode] = createSignal(false);\n  const [error, setError] = createSignal<string | null>(null);\n\n  // Model caching state\n  const [isModelLoading, setIsModelLoading] = createSignal(false);\n  const [modelProgress, setModelProgress] = createSignal(0);\n  const [isModelCached, setIsModelCached] = createSignal(false);\n  const [currentModelId, setCurrentModelId] = createSignal<string | null>(null);\n  const [downloadingFile, setDownloadingFile] = createSignal<string | null>(null);\n\n  // Per-model download status for ModelSelector\n  // Cloud providers and chrome-builtin don't need downloads - always \"ready\"\n  const [modelDownloadStatus, setModelDownloadStatus] = createSignal<\n    Record<TranslationProviderId, ModelDownloadStatus>\n  >({\n    'opus-mt': { isDownloading: false, progress: 0, isDownloaded: false, error: null },\n    'translategemma': { isDownloading: false, progress: 0, isDownloaded: false, error: null },\n    'chrome-builtin': { isDownloading: false, progress: 100, isDownloaded: true, error: null },\n    'deepl': { isDownloading: false, progress: 100, isDownloaded: true, error: null },\n    'openai': { isDownloading: false, progress: 100, isDownloaded: true, error: null },\n    'google-cloud': { isDownloading: false, progress: 100, isDownloaded: true, error: null },\n    'anthropic': { isDownloading: false, progress: 100, isDownloaded: true, error: null },\n  });\n\n  // Wrapper functions that persist language preferences to storage\n  const setSourceLang = (lang: string) => {\n    setSourceLangInternal(lang);\n    safeStorageSet({ sourceLang: lang });\n  };\n\n  const setTargetLang = (lang: string) => {\n    setTargetLangInternal(lang);\n    safeStorageSet({ targetLang: lang });\n    console.log('[Popup] Target language saved:', lang);\n  };\n\n  const setStrategy = (s: Strategy) => {\n    setStrategyInternal(s);\n    safeStorageSet({ strategy: s });\n  };\n\n  // Determine provider from model ID (e.g., \"Xenova/opus-mt-en-fi\" -> \"opus-mt\")\n  const getProviderFromModelId = (modelId: string): TranslationProviderId | null => {\n    if (modelId.includes('opus-mt')) return 'opus-mt';\n    if (modelId.includes('gemma') || modelId.includes('translategemma')) return 'translategemma';\n    return null;\n  };\n\n  // Update per-model download status\n  const updateModelStatus = (\n    providerId: TranslationProviderId,\n    updates: Partial<ModelDownloadStatus>\n  ) => {\n    setModelDownloadStatus((prev) => ({\n      ...prev,\n      [providerId]: { ...prev[providerId], ...updates },\n    }));\n  };\n\n  // Handle model progress messages from offscreen document\n  const handleModelProgress = (message: ModelProgressMessage) => {\n    if (message.type !== 'modelProgress') return;\n\n    console.log('[Popup] Model progress:', message.status, message.progress);\n    setCurrentModelId(message.modelId);\n\n    // Determine which provider this model belongs to\n    const providerId = getProviderFromModelId(message.modelId);\n\n    switch (message.status) {\n      case 'initiate':\n        setIsModelLoading(true);\n        setIsModelCached(false);\n        setModelProgress(0);\n        setProviderStatus('loading');\n        setDownloadingFile(message.file || null);\n        if (providerId) {\n          updateModelStatus(providerId, {\n            isDownloading: true,\n            progress: 0,\n            isDownloaded: false,\n            error: null,\n          });\n        }\n        break;\n      case 'download':\n      case 'progress':\n        setIsModelLoading(true);\n        setModelProgress(message.progress ?? 0);\n        setDownloadingFile(message.file || null);\n        if (providerId) {\n          updateModelStatus(providerId, {\n            isDownloading: true,\n            progress: message.progress ?? 0,\n          });\n        }\n        break;\n      case 'done':\n        setModelProgress(100);\n        setDownloadingFile(null);\n        if (providerId) {\n          updateModelStatus(providerId, {\n            progress: 100,\n          });\n        }\n        break;\n      case 'ready':\n        setIsModelLoading(false);\n        setIsModelCached(true);\n        setModelProgress(100);\n        setProviderStatus('ready');\n        setDownloadingFile(null);\n        if (providerId) {\n          updateModelStatus(providerId, {\n            isDownloading: false,\n            progress: 100,\n            isDownloaded: true,\n            error: null,\n          });\n        }\n        break;\n      case 'error':\n        setIsModelLoading(false);\n        setProviderStatus('error');\n        setDownloadingFile(null);\n        if (message.error) {\n          setError(`Model error: ${message.error}`);\n        }\n        if (providerId) {\n          updateModelStatus(providerId, {\n            isDownloading: false,\n            error: message.error || 'Unknown error',\n          });\n        }\n        break;\n    }\n  };\n\n  onMount(async () => {\n    // Listen for model progress messages\n    const messageListener = (message: ModelProgressMessage) => {\n      handleModelProgress(message);\n    };\n    browserAPI.runtime.onMessage.addListener(messageListener);\n\n    // Store cleanup function\n    onCleanup(() => {\n      browserAPI.runtime.onMessage.removeListener(messageListener);\n    });\n\n    // Load saved preferences (use internal setters to avoid re-saving)\n    interface StoredPrefs {\n      sourceLang?: string;\n      targetLang?: string;\n      strategy?: Strategy;\n      autoTranslate?: boolean;\n      provider?: TranslationProviderId;\n    }\n    const stored = await safeStorageGet<StoredPrefs>(['sourceLang', 'targetLang', 'strategy', 'autoTranslate', 'provider']);\n    if (stored.sourceLang) setSourceLangInternal(stored.sourceLang);\n    if (stored.targetLang) setTargetLangInternal(stored.targetLang);\n    if (stored.strategy) setStrategyInternal(stored.strategy);\n    if (stored.autoTranslate !== undefined) setAutoTranslate(stored.autoTranslate);\n    if (stored.provider) setActiveProvider(stored.provider);\n    console.log('[Popup] Loaded preferences:', { source: stored.sourceLang, target: stored.targetLang });\n\n    // Check Chrome Translator API availability (Chrome 138+)\n    try {\n      const response = await browserAPI.runtime.sendMessage({ type: 'checkChromeTranslator' });\n      if (response?.available) {\n        console.log('[Popup] Chrome Translator API available');\n        updateModelStatus('chrome-builtin', { isDownloaded: true, error: null });\n      } else {\n        console.log('[Popup] Chrome Translator API not available (Chrome 138+ required)');\n        updateModelStatus('chrome-builtin', { isDownloaded: false, error: 'Chrome 138+ required' });\n      }\n    } catch (e) {\n      console.log('[Popup] Chrome Translator check failed:', e);\n      updateModelStatus('chrome-builtin', { isDownloaded: false, error: 'Not available' });\n    }\n  });\n\n  const toggleAutoTranslate = async () => {\n    const newValue = !autoTranslate();\n    setAutoTranslate(newValue);\n    const saved = await safeStorageSet({\n      autoTranslate: newValue,\n      sourceLang: sourceLang(),\n      targetLang: targetLang(),\n      strategy: strategy(),\n    });\n    if (saved) {\n      console.log('[Popup] Auto-translate:', newValue);\n    }\n  };\n\n  const handleProviderChange = async (provider: TranslationProviderId) => {\n    setActiveProvider(provider);\n    setProviderStatus('ready');\n    setError(null);\n\n    await safeStorageSet({ provider });\n    try {\n      // Notify background service worker\n      await browserAPI.runtime.sendMessage({ type: 'setProvider', provider });\n      console.log('[Popup] Provider changed to:', provider);\n    } catch (e) {\n      console.error('[Popup] Failed to set provider:', e);\n    }\n  };\n\n  // Inject content script if not already loaded\n  const ensureContentScript = async (tabId: number): Promise<boolean> => {\n    try {\n      // Try to ping the content script\n      await browserAPI.tabs.sendMessage(tabId, { type: 'ping' });\n      return true;\n    } catch {\n      // Content script not loaded, inject it\n      console.log('[Popup] Injecting content script...');\n      try {\n        await browserAPI.scripting.executeScript({\n          target: { tabId },\n          files: ['content.js'],\n        });\n        // Wait a bit for script to initialize\n        await new Promise((resolve) => setTimeout(resolve, 100));\n        return true;\n      } catch (injectError) {\n        console.error('[Popup] Failed to inject content script:', injectError);\n        return false;\n      }\n    }\n  };\n\n  const handleToggleBilingual = async () => {\n    try {\n      const [tab] = await browserAPI.tabs.query({ active: true, currentWindow: true });\n      if (!tab?.id) return;\n\n      // Ensure content script is loaded\n      const injected = await ensureContentScript(tab.id);\n      if (!injected) {\n        setError('Cannot access this page');\n        return;\n      }\n\n      const response = await browserAPI.tabs.sendMessage(tab.id, { type: 'toggleBilingualMode' }) as { enabled: boolean } | undefined;\n      if (response) {\n        setBilingualMode(response.enabled);\n        console.log('[Popup] Bilingual mode:', response.enabled);\n      }\n    } catch (e) {\n      console.error('[Popup] Toggle bilingual mode failed:', e);\n    }\n  };\n\n  const handleError = (e: unknown) => {\n    const msg = e instanceof Error ? e.message : String(e);\n    const msgLower = msg.toLowerCase();\n\n    if (msg.includes('Cannot access')) {\n      setError('Cannot translate this page. Browser internal pages cannot be translated.');\n    } else if (msgLower.includes('language pair') || msgLower.includes('not available') || msgLower.includes('unsupported')) {\n      // Language pair errors - the message already includes suggestions from errors.ts\n      setError(msg);\n    } else if (msgLower.includes('network') || msgLower.includes('connection') || (msgLower.includes('fetch') && !msgLower.includes('model'))) {\n      setError(`Connection error: ${msg}. Check your internet connection.`);\n    } else if (msgLower.includes('timeout') || msgLower.includes('timed out')) {\n      setError(`${msg}. Try with less text or wait for the model to fully load.`);\n    } else if (msgLower.includes('model') || msgLower.includes('pipeline') || msgLower.includes('load')) {\n      setError(`${msg}. Try waiting for the model to download, or switch to Chrome Built-in translator.`);\n    } else if (msgLower.includes('memory') || msgLower.includes('oom')) {\n      setError(`${msg}. Try closing other tabs or using a smaller text selection.`);\n    } else {\n      setError(msg || 'Translation failed. Please try again or select a different provider.');\n    }\n    // Clear error after 8 seconds (longer to read suggestions)\n    setTimeout(() => setError(null), 8000);\n  };\n\n  const handleTranslateSelection = async () => {\n    setIsTranslating(true);\n    setError(null);\n    try {\n      const [tab] = await browserAPI.tabs.query({ active: true, currentWindow: true });\n      if (!tab?.id) {\n        setError('No active tab');\n        return;\n      }\n      // Check if it's a restricted URL (handles both Chrome and Firefox)\n      const restrictedPrefixes = [\n        'chrome://', 'about:', 'chrome-extension://',\n        'moz-extension://', 'resource://', 'view-source:'\n      ];\n      if (tab.url && restrictedPrefixes.some(prefix => tab.url!.startsWith(prefix))) {\n        setError('Cannot translate browser pages');\n        return;\n      }\n      // Ensure content script is loaded\n      const injected = await ensureContentScript(tab.id);\n      if (!injected) {\n        setError('Cannot access this page');\n        return;\n      }\n      await browserAPI.tabs.sendMessage(tab.id, {\n        type: 'translateSelection',\n        sourceLang: sourceLang(),\n        targetLang: targetLang(),\n        strategy: strategy(),\n        provider: activeProvider(),\n      });\n    } catch (e) {\n      console.error('[Popup] Translation failed:', e);\n      handleError(e);\n    } finally {\n      setIsTranslating(false);\n    }\n  };\n\n  const handleTranslatePage = async () => {\n    setIsTranslating(true);\n    setError(null);\n    try {\n      const [tab] = await browserAPI.tabs.query({ active: true, currentWindow: true });\n      if (!tab?.id) {\n        setError('No active tab');\n        return;\n      }\n      // Check if it's a restricted URL (handles both Chrome and Firefox)\n      const restrictedPrefixes = [\n        'chrome://', 'about:', 'chrome-extension://',\n        'moz-extension://', 'resource://', 'view-source:'\n      ];\n      if (tab.url && restrictedPrefixes.some(prefix => tab.url!.startsWith(prefix))) {\n        setError('Cannot translate browser pages');\n        return;\n      }\n      // Ensure content script is loaded\n      const injected = await ensureContentScript(tab.id);\n      if (!injected) {\n        setError('Cannot access this page');\n        return;\n      }\n      await browserAPI.tabs.sendMessage(tab.id, {\n        type: 'translatePage',\n        sourceLang: sourceLang(),\n        targetLang: targetLang(),\n        strategy: strategy(),\n        provider: activeProvider(),\n      });\n    } catch (e) {\n      console.error('[Popup] Page translation failed:', e);\n      handleError(e);\n    } finally {\n      setIsTranslating(false);\n    }\n  };\n\n  const swapLanguages = () => {\n    if (sourceLang() !== 'auto') {\n      const temp = sourceLang();\n      setSourceLang(targetLang());\n      setTargetLang(temp);\n    }\n  };\n\n  const handleUndo = async () => {\n    try {\n      const [tab] = await browserAPI.tabs.query({ active: true, currentWindow: true });\n      if (!tab?.id) return;\n\n      const injected = await ensureContentScript(tab.id);\n      if (!injected) return;\n\n      await browserAPI.tabs.sendMessage(tab.id, { type: 'undoTranslation' });\n    } catch (e) {\n      console.error('[Popup] Undo failed:', e);\n    }\n  };\n\n  const openSettings = () => {\n    browserAPI.runtime.openOptionsPage();\n  };\n\n  return (\n    <div class=\"popup-container\">\n      {/* Header */}\n      <header class=\"popup-header\">\n        <div class=\"header-brand\">\n          <div class=\"brand-icon\">\n            <svg width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\">\n              <path\n                d=\"M3 5h12M9 3v2m1.048 3.5A3.5 3.5 0 016.5 12a3.5 3.5 0 01-2.45-5.943M6 16l-2 6 3-2 3 2-2-6M21 21l-6-6m6 0l-6 6M15 15l6-6m-6 0l6 6\"\n                stroke=\"currentColor\"\n                stroke-width=\"2\"\n                stroke-linecap=\"round\"\n                stroke-linejoin=\"round\"\n              />\n            </svg>\n          </div>\n          <div class=\"brand-text\">\n            <h1 class=\"brand-title\">TRANSLATE!</h1>\n            <span class=\"brand-author\">by Mikko</span>\n          </div>\n          <button class=\"settings-button\" onClick={openSettings} aria-label=\"Settings\">\n            <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\">\n              <circle cx=\"12\" cy=\"12\" r=\"3\" stroke=\"currentColor\" stroke-width=\"2\" />\n              <path\n                d=\"M19.4 15a1.65 1.65 0 00.33 1.82l.06.06a2 2 0 010 2.83 2 2 0 01-2.83 0l-.06-.06a1.65 1.65 0 00-1.82-.33 1.65 1.65 0 00-1 1.51V21a2 2 0 01-2 2 2 2 0 01-2-2v-.09A1.65 1.65 0 009 19.4a1.65 1.65 0 00-1.82.33l-.06.06a2 2 0 01-2.83 0 2 2 0 010-2.83l.06-.06a1.65 1.65 0 00.33-1.82 1.65 1.65 0 00-1.51-1H3a2 2 0 01-2-2 2 2 0 012-2h.09A1.65 1.65 0 004.6 9a1.65 1.65 0 00-.33-1.82l-.06-.06a2 2 0 010-2.83 2 2 0 012.83 0l.06.06a1.65 1.65 0 001.82.33H9a1.65 1.65 0 001-1.51V3a2 2 0 012-2 2 2 0 012 2v.09a1.65 1.65 0 001 1.51 1.65 1.65 0 001.82-.33l.06-.06a2 2 0 012.83 0 2 2 0 010 2.83l-.06.06a1.65 1.65 0 00-.33 1.82V9a1.65 1.65 0 001.51 1H21a2 2 0 012 2 2 2 0 01-2 2h-.09a1.65 1.65 0 00-1.51 1z\"\n                stroke=\"currentColor\"\n                stroke-width=\"2\"\n              />\n            </svg>\n          </button>\n        </div>\n        <ProviderStatus name={providerName()} status={providerStatus()} />\n        <ModelStatus\n          isLoading={isModelLoading()}\n          progress={modelProgress()}\n          isCached={isModelCached()}\n          modelId={currentModelId()}\n          currentFile={downloadingFile()}\n        />\n      </header>\n\n      <main class=\"popup-main\">\n        {/* Model Selection with Download Status */}\n        <ModelSelector\n          selected={activeProvider()}\n          onChange={handleProviderChange}\n          downloadStatus={modelDownloadStatus()}\n        />\n\n        {/* Language Selection */}\n        <LanguageSelector\n          sourceLang={sourceLang()}\n          targetLang={targetLang()}\n          onSourceChange={setSourceLang}\n          onTargetChange={setTargetLang}\n          onSwap={swapLanguages}\n        />\n\n        {/* Strategy Selection */}\n        <StrategySelector selected={strategy()} onChange={setStrategy} />\n\n        {/* Auto-Translate Toggle */}\n        <section class=\"auto-section\">\n          <label class=\"auto-toggle\">\n            <input\n              type=\"checkbox\"\n              checked={autoTranslate()}\n              onChange={toggleAutoTranslate}\n            />\n            <span class=\"toggle-slider\"></span>\n            <span class=\"toggle-label\">Auto-translate pages</span>\n          </label>\n          <label class=\"auto-toggle\">\n            <input\n              type=\"checkbox\"\n              checked={bilingualMode()}\n              onChange={handleToggleBilingual}\n            />\n            <span class=\"toggle-slider\"></span>\n            <span class=\"toggle-label\">Bilingual mode</span>\n          </label>\n        </section>\n\n        {/* Error Display */}\n        <Show when={error()}>\n          <div class=\"error-banner\" role=\"alert\">\n            <svg class=\"error-banner__icon\" viewBox=\"0 0 24 24\" fill=\"none\">\n              <circle cx=\"12\" cy=\"12\" r=\"10\" stroke=\"currentColor\" stroke-width=\"2\"/>\n              <line x1=\"12\" y1=\"8\" x2=\"12\" y2=\"12\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\"/>\n              <circle cx=\"12\" cy=\"16\" r=\"1\" fill=\"currentColor\"/>\n            </svg>\n            <div class=\"error-banner__content\">\n              <div class=\"error-banner__message\">{error()}</div>\n            </div>\n            <button\n              class=\"error-banner__dismiss\"\n              onClick={() => setError(null)}\n              aria-label=\"Dismiss error\"\n            >\n              <svg width=\"14\" height=\"14\" viewBox=\"0 0 24 24\" fill=\"none\">\n                <path d=\"M18 6L6 18M6 6l12 12\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\"/>\n              </svg>\n            </button>\n          </div>\n        </Show>\n\n        {/* Action Buttons - Compact */}\n        <section class=\"action-bar\">\n          <button\n            class=\"action-btn action-btn--primary\"\n            onClick={handleTranslatePage}\n            disabled={isTranslating()}\n            title=\"Translate entire page\"\n          >\n            <Show when={!isTranslating()} fallback={<span class=\"spinner-small\" />}>\n              <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\">\n                <path d=\"M3 5h12M9 3v2m1.048 3.5A3.5 3.5 0 016.5 12a3.5 3.5 0 01-2.45-5.943M6 16l-2 6 3-2 3 2-2-6\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"/>\n              </svg>\n            </Show>\n            <span>Page</span>\n          </button>\n\n          <button\n            class=\"action-btn action-btn--secondary\"\n            onClick={handleTranslateSelection}\n            disabled={isTranslating()}\n            title=\"Translate selected text\"\n          >\n            <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\">\n              <path d=\"M4 7V4h16v3M9 20h6M12 4v16\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"/>\n            </svg>\n            <span>Selection</span>\n          </button>\n\n          <button\n            class=\"action-btn action-btn--tertiary\"\n            onClick={handleUndo}\n            title=\"Undo translation\"\n          >\n            <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\">\n              <path d=\"M3 7v6h6M3 13a9 9 0 1018 0 9 9 0 00-15-6.7L3 7\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"/>\n            </svg>\n            <span>Undo</span>\n          </button>\n        </section>\n      </main>\n    </div>\n  );\n}\n","/* @refresh reload */\nimport { render } from 'solid-js/web';\nimport App from './App';\n\nconst root = document.getElementById('root');\n\nif (root) {\n  render(() => <App />, root);\n}\n"],"names":["ProviderStatus","props","statusIndicator","status","icon","text","class","_el$","_tmpl$","_el$2","firstChild","_el$3","_el$4","nextSibling","_el$5","_el$6","_$insert","name","_$effect","_$className","LOCAL_MODELS","id","tag","description","size","CLOUD_PROVIDERS","isCloud","costEstimate","MODELS","ModelSelector","cloudApiStatus","setCloudApiStatus","createSignal","isOpen","setIsOpen","onMount","response","chrome","runtime","sendMessage","type","getStatus","modelId","downloadStatus","isDownloading","progress","isDownloaded","error","isCloudConfigured","selectedModel","find","m","selected","handleSelect","openOptionsPage","onChange","getStatusIcon","model","_tmpl$3","$$click","_$createComponent","Show","when","children","_el$7","_el$8","_el$0","_el$1","_el$10","_el$11","For","each","_el$14","_tmpl$4","_el$15","_el$16","_el$17","_el$18","_el$19","_p$","_v$","_v$2","e","t","_$setAttribute","undefined","stopPropagation","_el$20","_tmpl$5","_el$21","_el$22","_el$23","_el$24","_el$25","_v$3","_v$4","_el$12","_tmpl$2","_el$13","_$p","_$setStyleProperty","_$delegateEvents","LANGUAGES","code","flag","LanguageSelector","_el$9","addEventListener","onSourceChange","target","value","lang","_$addEventListener","onSwap","onTargetChange","filter","l","sourceLang","targetLang","STRATEGIES","label","title","StrategySelector","strategy","a","getShortModelName","match","toUpperCase","getShortFileName","file","parts","split","length","getEstimatedSize","ModelStatus","isLoading","isCached","_c$","_$memo","Math","round","currentFile","getBrowserLanguage","navigator","language","App","setSourceLangInternal","setTargetLangInternal","setStrategyInternal","activeProvider","setActiveProvider","providerStatus","setProviderStatus","providerName","isTranslating","setIsTranslating","autoTranslate","setAutoTranslate","bilingualMode","setBilingualMode","setError","isModelLoading","setIsModelLoading","modelProgress","setModelProgress","isModelCached","setIsModelCached","currentModelId","setCurrentModelId","downloadingFile","setDownloadingFile","modelDownloadStatus","setModelDownloadStatus","setSourceLang","safeStorageSet","setTargetLang","console","log","setStrategy","s","getProviderFromModelId","includes","updateModelStatus","providerId","updates","prev","handleModelProgress","message","messageListener","browserAPI","onMessage","addListener","onCleanup","removeListener","stored","safeStorageGet","provider","source","available","toggleAutoTranslate","newValue","handleProviderChange","ensureContentScript","tabId","tabs","scripting","executeScript","files","Promise","resolve","setTimeout","injectError","handleToggleBilingual","tab","query","active","currentWindow","enabled","handleError","msg","Error","String","msgLower","toLowerCase","handleTranslateSelection","restrictedPrefixes","url","some","prefix","startsWith","handleTranslatePage","swapLanguages","temp","handleUndo","openSettings","fallback","disabled","checked","root","document","getElementById","render"],"mappings":"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"}