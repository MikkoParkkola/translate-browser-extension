import"./modulepreload-polyfill-B5Qt9EMX.js";import{d as ze,b as o,o as Ge,i as e,e as a,c as i,F as W,m as Me,t as n,S as v,a as Ee,s as Ze,f as ot,r as ct}from"./solid-BsdPOvgA.js";import{s as dt,a as ut}from"./storage--5bP51BW.js";import{g as Re,s as Ue}from"./site-rules-I3TDES-2.js";var gt=n('<div><h2 class=section-title style=margin-bottom:1.5rem>General Settings</h2><section class=settings-section><div class=section-header><div><h3 class=section-title>Default Languages</h3><p class=section-subtitle>Set your preferred source and target languages</p></div></div><div class=form-row><div class=form-group><label class=form-label>Source Language</label><select class=form-select></select><p class=form-hint>Auto Detect works best in most cases</p></div><div class=form-group><label class=form-label>Target Language</label><select class=form-select></select><p class=form-hint>The language you want text translated into</p></div></div></section><section class=settings-section><div class=section-header><div><h3 class=section-title>Translation Strategy</h3><p class=section-subtitle>How translations should be processed</p></div></div><div class=form-group><label class=form-label>Default Strategy</label><select class=form-select></select></div></section><section class=settings-section><div class=section-header><div><h3 class=section-title>Automatic Translation</h3><p class=section-subtitle>Configure automatic page translation</p></div></div><div class=toggle-container><div class=toggle-info><span class=toggle-label>Auto-translate pages</span><p class=toggle-description>Automatically translate pages when the source language differs from your target language</p></div><label class=toggle-switch><input type=checkbox><span class=toggle-slider></span></label></div></section><div class=btn-group style=margin-top:1.5rem><button class="btn btn-primary btn-lg">'),et=n("<option>"),ht=n("<option> - "),mt=n("<span class=spinner>");const tt=[{code:"auto",name:"Auto Detect"},{code:"en",name:"English"},{code:"fi",name:"Finnish"},{code:"de",name:"German"},{code:"fr",name:"French"},{code:"es",name:"Spanish"},{code:"sv",name:"Swedish"},{code:"ru",name:"Russian"},{code:"zh",name:"Chinese"},{code:"ja",name:"Japanese"},{code:"nl",name:"Dutch"},{code:"cs",name:"Czech"},{code:"pt",name:"Portuguese"},{code:"it",name:"Italian"},{code:"pl",name:"Polish"},{code:"ko",name:"Korean"}],pt=[{id:"smart",name:"Smart",description:"Auto-select best provider based on content"},{id:"fast",name:"Fast",description:"Prioritize speed over quality"},{id:"quality",name:"Quality",description:"Prioritize accuracy over speed"},{id:"cost",name:"Cost",description:"Prioritize free/local providers"},{id:"balanced",name:"Balanced",description:"Balance between speed, quality, and cost"}],vt=()=>{const[$,C]=o("auto"),[G,R]=o("en"),[y,I]=o("smart"),[U,L]=o(!1),[H,E]=o(!1),[u,k]=o(!1);Ge(async()=>{const g=await ut(["sourceLang","targetLang","strategy","autoTranslate"]);g.sourceLang&&C(g.sourceLang),g.targetLang&&R(g.targetLang),g.strategy&&I(g.strategy),g.autoTranslate!==void 0&&L(g.autoTranslate)});const x=async()=>{k(!0);const g=await dt({sourceLang:$(),targetLang:G(),strategy:y(),autoTranslate:U()});k(!1),g&&(E(!0),setTimeout(()=>E(!1),2e3))};return(()=>{var g=gt(),m=g.firstChild,z=m.nextSibling,b=z.firstChild,D=b.nextSibling,N=D.firstChild,A=N.firstChild,M=A.nextSibling,c=N.nextSibling,d=c.firstChild,s=d.nextSibling,t=z.nextSibling,S=t.firstChild,Y=S.nextSibling,Z=Y.firstChild,X=Z.nextSibling,ee=t.nextSibling,te=ee.firstChild,V=te.nextSibling,f=V.firstChild,O=f.nextSibling,he=O.firstChild,fe=ee.nextSibling,me=fe.firstChild;return M.addEventListener("change",T=>C(T.currentTarget.value)),e(M,a(W,{each:tt,children:T=>(()=>{var K=et();return e(K,()=>T.name),i(()=>K.value=T.code),K})()})),s.addEventListener("change",T=>R(T.currentTarget.value)),e(s,a(W,{get each(){return tt.filter(T=>T.code!=="auto")},children:T=>(()=>{var K=et();return e(K,()=>T.name),i(()=>K.value=T.code),K})()})),X.addEventListener("change",T=>I(T.currentTarget.value)),e(X,a(W,{each:pt,children:T=>(()=>{var K=ht(),_e=K.firstChild;return e(K,()=>T.name,_e),e(K,()=>T.description,null),i(()=>K.value=T.id),K})()})),he.addEventListener("change",T=>L(T.currentTarget.checked)),me.$$click=x,e(me,(()=>{var T=Me(()=>!!u());return()=>T()?[mt(),"Saving..."]:H()?"Saved!":"Save Settings"})()),i(()=>me.disabled=u()),i(()=>M.value=$()),i(()=>s.value=G()),i(()=>X.value=y()),i(()=>he.checked=U()),g})()};ze(["click"]);var $t=n("<div><h2 class=section-title style=margin-bottom:0.5rem>Cloud Translation Providers</h2><p class=section-description>Configure API keys for cloud-based translation services. Each provider offers different strengths - DeepL excels at European languages, while GPT models handle context better."),bt=n("<span>"),ft=n('<span class="badge badge-info">Pro'),_t=n('<span class="badge badge-neutral">Not configured'),yt=n("<button>"),St=n('<button class="btn btn-sm btn-secondary">'),wt=n("<div>"),xt=n('<div class="alert alert-error">'),Ct=n('<div class=toggle-container style="padding:0.5rem 0"><div class=toggle-info><span class=toggle-label>Pro tier (paid account)</span><p class=toggle-description>Uses the paid API endpoint for higher limits</p></div><label class=toggle-switch><input type=checkbox><span class=toggle-slider>'),kt=n("<div class=form-group><label class=form-label>Model</label><select class=form-select>"),Tt=n('<div class=provider-form><div class=form-group><label class=form-label>API Key</label><input type=password class=form-input autocomplete=off></div><div class=provider-actions><button class="btn btn-primary"></button><button class="btn btn-secondary">Cancel</button><a target=_blank rel="noopener noreferrer"class="btn btn-ghost">Get API key'),Lt=n('<button class="btn btn-danger">Remove'),At=n('<div class=provider-actions><button class="btn btn-secondary">'),Et=n("<div><div class=provider-header><div class=provider-info><span class=provider-name></span></div><div class=btn-group></div></div><p class=provider-description>"),Mt=n("<span class=spinner>"),Pt=n("<option>");const Le=[{id:"deepl",name:"DeepL",keyField:"deepl_api_key",enabledField:"deepl_enabled",hasProTier:!0,proField:"deepl_is_pro",placeholder:"xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx:fx",helpUrl:"https://www.deepl.com/pro-api",description:"Premium translation quality. Free tier: 500K chars/month.",testEndpoint:"https://api-free.deepl.com/v2/usage"},{id:"openai",name:"OpenAI",keyField:"openai_api_key",enabledField:"openai_enabled",modelField:"openai_model",hasProTier:!1,placeholder:"sk-...",helpUrl:"https://platform.openai.com/api-keys",description:"GPT-4 powered translations with context understanding.",models:["gpt-4o","gpt-4o-mini","gpt-4-turbo","gpt-3.5-turbo"]},{id:"google-cloud",name:"Google Cloud",keyField:"google_cloud_api_key",enabledField:"google_cloud_enabled",hasProTier:!1,placeholder:"AIza...",helpUrl:"https://cloud.google.com/translate/docs/setup",description:"Google Cloud Translation API v2."},{id:"anthropic",name:"Claude (Anthropic)",keyField:"anthropic_api_key",enabledField:"anthropic_enabled",modelField:"anthropic_model",hasProTier:!1,placeholder:"sk-ant-...",helpUrl:"https://console.anthropic.com/settings/keys",description:"Claude-powered translations with nuanced understanding.",models:["claude-sonnet-4-20250514","claude-3-5-haiku-latest"]}],Ft=()=>{const[$,C]=o({}),[G,R]=o(null),[y,I]=o(""),[U,L]=o(!1),[H,E]=o(""),[u,k]=o(!1),[x,g]=o(null);Ge(async()=>{await m()});const m=async()=>{const c={};try{const d=Le.flatMap(t=>{const S=[t.keyField,t.enabledField];return t.hasProTier&&t.proField&&S.push(t.proField),t.modelField&&S.push(t.modelField),S}),s=await chrome.storage.local.get(d);for(const t of Le)c[t.id]={hasKey:!!s[t.keyField],enabled:s[t.enabledField]??!1,isPro:t.hasProTier&&t.proField?s[t.proField]:void 0,model:t.modelField?s[t.modelField]:void 0}}catch(d){console.error("[CloudProviders] Failed to load status:",d)}C(c)},z=c=>{const d=Le.find(t=>t.id===c),s=$()[c];R(c),I(""),L(s?.isPro??!1),E(s?.model||d?.models?.[0]||""),g(null)},b=()=>{R(null),I(""),g(null)},D=async c=>{const d=Le.find(t=>t.id===c);if(!d)return;const s=y().trim();if(!s){g("Please enter an API key");return}k(!0),g(null);try{const t={[d.keyField]:s,[d.enabledField]:!0};d.hasProTier&&d.proField&&(t[d.proField]=U()),d.modelField&&(t[d.modelField]=H()),await chrome.storage.local.set(t),C(S=>({...S,[c]:{hasKey:!0,enabled:!0,isPro:U(),model:H()}})),R(null)}catch(t){console.error("[CloudProviders] Failed to save key:",t),g("Failed to save API key")}finally{k(!1)}},N=async c=>{const d=Le.find(s=>s.id===c);if(d&&confirm(`Remove ${d.name} API key?`))try{const s=[d.keyField,d.enabledField];d.hasProTier&&d.proField&&s.push(d.proField),d.modelField&&s.push(d.modelField),await chrome.storage.local.remove(s),C(t=>({...t,[c]:{hasKey:!1,enabled:!1}}))}catch(s){console.error("[CloudProviders] Failed to remove key:",s)}},A=async c=>{const d=Le.find(S=>S.id===c),s=$()[c];if(!d||!s?.hasKey)return;const t=!s.enabled;try{await chrome.storage.local.set({[d.enabledField]:t}),C(S=>({...S,[c]:{...S[c],enabled:t}}))}catch(S){console.error("[CloudProviders] Failed to toggle provider:",S)}},M=async c=>{if(Le.find(s=>s.id===c)){C(s=>({...s,[c]:{...s[c],testing:!0,testResult:null}}));try{const s=await chrome.runtime.sendMessage({type:"testProvider",provider:c});C(t=>({...t,[c]:{...t[c],testing:!1,testResult:s?.success?"success":"error",testMessage:s?.message||(s?.success?"Connection successful":"Test failed")}})),setTimeout(()=>{C(t=>({...t,[c]:{...t[c],testResult:null,testMessage:void 0}}))},3e3)}catch(s){console.error("[CloudProviders] Test failed:",s),C(t=>({...t,[c]:{...t[c],testing:!1,testResult:"error",testMessage:"Test failed: "+(s instanceof Error?s.message:"Unknown error")}}))}}};return(()=>{var c=$t(),d=c.firstChild;return d.nextSibling,e(c,a(W,{each:Le,children:s=>{const t=()=>$()[s.id]||{hasKey:!1,enabled:!1},S=()=>G()===s.id;return(()=>{var Y=Et(),Z=Y.firstChild,X=Z.firstChild,ee=X.firstChild,te=X.nextSibling,V=Z.nextSibling;return e(ee,()=>s.name),e(X,a(v,{get when(){return t().hasKey},get children(){return[(()=>{var f=bt();return e(f,()=>t().enabled?"Enabled":"Disabled"),i(()=>Ee(f,`badge ${t().enabled?"badge-success":"badge-neutral"}`)),f})(),a(v,{get when(){return t().isPro},get children(){return ft()}})]}}),null),e(X,a(v,{get when(){return!t().hasKey},get children(){return _t()}}),null),e(te,a(v,{get when(){return Me(()=>!!t().hasKey)()&&!S()},get children(){return[(()=>{var f=yt();return f.$$click=()=>A(s.id),e(f,()=>t().enabled?"Disable":"Enable"),i(()=>Ee(f,`btn btn-sm ${t().enabled?"btn-secondary":"btn-primary"}`)),f})(),(()=>{var f=St();return f.$$click=()=>M(s.id),e(f,(()=>{var O=Me(()=>!!t().testing);return()=>O()?Mt():"Test"})()),i(()=>f.disabled=t().testing),f})()]}})),e(V,()=>s.description),e(Y,a(v,{get when(){return t().testResult},get children(){var f=wt();return e(f,()=>t().testMessage),i(()=>Ee(f,`alert ${t().testResult==="success"?"alert-success":"alert-error"}`)),f}}),null),e(Y,a(v,{get when(){return S()},get children(){var f=Tt(),O=f.firstChild,he=O.firstChild,fe=he.nextSibling,me=O.nextSibling,T=me.firstChild,K=T.nextSibling,_e=K.nextSibling;return e(f,a(v,{get when(){return x()},get children(){var B=xt();return e(B,x),B}}),O),fe.$$input=B=>I(B.currentTarget.value),e(f,a(v,{get when(){return s.hasProTier},get children(){var B=Ct(),l=B.firstChild,r=l.nextSibling,w=r.firstChild;return w.addEventListener("change",p=>L(p.currentTarget.checked)),i(()=>w.checked=U()),B}}),me),e(f,a(v,{get when(){return Me(()=>!!s.models)()&&s.models.length>0},get children(){var B=kt(),l=B.firstChild,r=l.nextSibling;return r.addEventListener("change",w=>E(w.currentTarget.value)),e(r,a(W,{get each(){return s.models},children:w=>(()=>{var p=Pt();return p.value=w,e(p,w),p})()})),i(()=>r.value=H()),B}}),me),T.$$click=()=>D(s.id),e(T,()=>u()?"Saving...":"Save"),K.$$click=b,i(B=>{var l=s.placeholder,r=u(),w=s.helpUrl;return l!==B.e&&Ze(fe,"placeholder",B.e=l),r!==B.t&&(T.disabled=B.t=r),w!==B.a&&Ze(_e,"href",B.a=w),B},{e:void 0,t:void 0,a:void 0}),i(()=>fe.value=y()),f}}),null),e(Y,a(v,{get when(){return!S()},get children(){var f=At(),O=f.firstChild;return O.$$click=()=>z(s.id),e(O,()=>t().hasKey?"Update API Key":"Add API Key"),e(f,a(v,{get when(){return t().hasKey},get children(){var he=Lt();return he.$$click=()=>N(s.id),he}}),null),f}}),null),i(()=>Ee(Y,`provider-card ${t().enabled?"enabled":""}`)),Y})()}}),null),c})()};ze(["click","input"]);var Rt=n("<div class=settings-section><div class=loading style=height:100px><span class=spinner>"),zt=n('<section class=settings-section><div class=section-header><div><h3 class=section-title>Storage Usage</h3><p class=section-subtitle>Local storage used by downloaded models</p></div></div><div style=margin-bottom:1rem><div style=display:flex;justify-content:space-between;margin-bottom:0.5rem><span style=font-weight:500></span><span style=color:var(--color-gray-500)>of <!> available</span></div><div class=progress-bar><div></div></div></div><button class="btn btn-danger">Clear All Models'),Gt=n("<section class=settings-section><div class=section-header><h3 class=section-title>Downloaded Models"),Ut=n("<section class=settings-section><div class=section-header><h3 class=section-title>About Local Models</h3></div><div style=font-size:0.875rem;color:var(--color-gray-600)><p style=margin-bottom:0.75rem><strong>OPUS-MT Models</strong> (~300MB each): Helsinki-NLP translation models. Fast and accurate for European languages.</p><p style=margin-bottom:0.75rem><strong>TranslateGemma</strong> (~2.5GB): Google's multilingual model. Supports 8 languages with high quality but requires WebGPU.</p><p>Models are stored in IndexedDB and persist across browser restarts. They are downloaded on first use for each language pair."),Dt=n("<div><h2 class=section-title style=margin-bottom:0.5rem>Local Models</h2><p class=section-description>Manage downloaded translation models. Local models run entirely on your device without sending data to any server."),Bt=n('<div class=empty-state><svg viewBox="0 0 24 24"fill=none><rect x=4 y=4 width=16 height=16 rx=2 stroke=currentColor stroke-width=2></rect><path d="M9 9h6M9 13h6M9 17h4"stroke=currentColor stroke-width=2 stroke-linecap=round></path></svg><p>No models downloaded yet</p><p style=font-size:0.875rem>Models will be downloaded automatically when you first use a language pair.'),Nt=n('<div class=model-card><div class=model-info><div class=model-name></div><div class=model-size></div></div><div class=model-actions><button class="btn btn-sm btn-danger">'),It=n("<span class=spinner>");function Qe($){if($===0)return"0 B";const C=1024,G=["B","KB","MB","GB"],R=Math.floor(Math.log($)/Math.log(C));return parseFloat(($/Math.pow(C,R)).toFixed(1))+" "+G[R]}function jt($){return new Date($).toLocaleDateString(void 0,{year:"numeric",month:"short",day:"numeric"})}const Ot=()=>{const[$,C]=o(!0),[G,R]=o({totalUsed:0,quota:0,models:[]}),[y,I]=o(null);Ge(async()=>{await U()});const U=async()=>{C(!0);try{let u={usage:0,quota:0};"storage"in navigator&&"estimate"in navigator.storage&&(u=await navigator.storage.estimate());const x=(await chrome.storage.local.get(["downloadedModels"])).downloadedModels||[];try{const z=await chrome.runtime.sendMessage({type:"getDownloadedModels"});if(z?.models){R({totalUsed:u.usage||0,quota:u.quota||0,models:z.models}),C(!1);return}}catch{}const g=[{id:"opus-mt-en-fi",name:"OPUS-MT English-Finnish",size:300*1024*1024},{id:"opus-mt-fi-en",name:"OPUS-MT Finnish-English",size:300*1024*1024},{id:"opus-mt-en-de",name:"OPUS-MT English-German",size:300*1024*1024},{id:"opus-mt-de-en",name:"OPUS-MT German-English",size:300*1024*1024},{id:"translategemma",name:"TranslateGemma 4B",size:2.5*1024*1024*1024}],m=x.length>0?x:g.filter(()=>u.usage&&u.usage>100*1024*1024);R({totalUsed:u.usage||0,quota:u.quota||0,models:m})}catch(u){console.error("[LocalModels] Failed to load stats:",u)}finally{C(!1)}},L=async u=>{if(confirm(`Delete model "${u}"? You will need to re-download it to use it again.`)){I(u);try{await chrome.runtime.sendMessage({type:"deleteModel",modelId:u}),R(k=>({...k,models:k.models.filter(x=>x.id!==u)})),await U()}catch(k){console.error("[LocalModels] Failed to delete model:",k),alert("Failed to delete model. It may be in use.")}finally{I(null)}}},H=async()=>{if(confirm("Delete ALL downloaded models? This will free up storage but you will need to re-download models when needed."))try{if(await chrome.runtime.sendMessage({type:"clearAllModels"}),"caches"in window){const u=await caches.keys();for(const k of u)(k.includes("transformers")||k.includes("model"))&&await caches.delete(k)}await U()}catch(u){console.error("[LocalModels] Failed to clear models:",u),alert("Failed to clear models. Some models may still be cached.")}},E=()=>{const u=G();return u.quota===0?0:Math.min(100,u.totalUsed/u.quota*100)};return(()=>{var u=Dt(),k=u.firstChild;return k.nextSibling,e(u,a(v,{get when(){return $()},get children(){var x=Rt();return x.firstChild,x}}),null),e(u,a(v,{get when(){return!$()},get children(){return[(()=>{var x=zt(),g=x.firstChild,m=g.nextSibling,z=m.firstChild,b=z.firstChild,D=b.nextSibling,N=D.firstChild,A=N.nextSibling;A.nextSibling;var M=z.nextSibling,c=M.firstChild,d=m.nextSibling;return e(b,()=>Qe(G().totalUsed)),e(D,()=>Qe(G().quota),A),d.$$click=H,i(s=>{var t=`progress-fill ${E()>80?"danger":E()>50?"warning":""}`,S=`${E()}%`;return t!==s.e&&Ee(c,s.e=t),S!==s.t&&ot(c,"width",s.t=S),s},{e:void 0,t:void 0}),x})(),(()=>{var x=Gt();return x.firstChild,e(x,a(v,{get when(){return G().models.length>0},get fallback(){return(()=>{var g=Bt(),m=g.firstChild,z=m.nextSibling;return z.nextSibling,g})()},get children(){return a(W,{get each(){return G().models},children:g=>(()=>{var m=Nt(),z=m.firstChild,b=z.firstChild,D=b.nextSibling,N=z.nextSibling,A=N.firstChild;return e(b,()=>g.name||g.id),e(D,()=>Qe(g.size),null),e(D,a(v,{get when(){return g.lastUsed},get children(){return[" | Last used: ",Me(()=>jt(g.lastUsed))]}}),null),A.$$click=()=>L(g.id),e(A,(()=>{var M=Me(()=>y()===g.id);return()=>M()?It():"Delete"})()),i(()=>A.disabled=y()===g.id),m})()})}}),null),x})(),(()=>{var x=Ut(),g=x.firstChild,m=g.nextSibling,z=m.firstChild;return z.nextSibling,x})()]}}),null),u})()};ze(["click"]);var Kt=n('<div class="alert alert-error">'),qt=n('<div class="alert alert-success">'),Ht=n('<section class=settings-section><h3 class=section-title style=margin-bottom:1rem>Add New Term</h3><div class=form-row><div class=form-group><label class=form-label>Source Term</label><input type=text class=form-input placeholder="e.g., API"></div><div class=form-group><label class=form-label>Replacement</label><input type=text class=form-input placeholder="e.g., rajapinta"></div></div><div class=form-row><div class=form-group><label class=form-label>Language (optional)</label><select class=form-select></select><p class=form-hint>Apply only when translating to this language</p></div><div class=form-group><label class=form-label>Description (optional)</label><input type=text class=form-input placeholder="e.g., Technical term"></div></div><div class=toggle-container style="padding:0.5rem 0"><div class=toggle-info><span class=toggle-label>Case sensitive</span><p class=toggle-description>Match exact case only (API vs api)</p></div><label class=toggle-switch><input type=checkbox><span class=toggle-slider></span></label></div><div class=btn-group style=margin-top:1rem><button class="btn btn-primary">Add Term</button><button class="btn btn-secondary">Cancel'),Vt=n('<button class="btn btn-danger">Clear All'),Jt=n('<div><h2 class=section-title style=margin-bottom:0.5rem>Glossary</h2><p class=section-description>Define custom term replacements. Terms are replaced before translation and the replacement is used in the output. Useful for proper nouns, technical terms, or company-specific vocabulary.</p><section class=settings-section><div style=display:flex;gap:1rem;flex-wrap:wrap;align-items:center><div style=flex:1;min-width:200px><input type=text class=form-input placeholder="Search terms..."></div><select class=form-select style=width:160px></select><button class="btn btn-primary"></button></div></section><section class=settings-section><div class=section-header><h3 class=section-title>Terms (<!>)</h3></div></section><section class=settings-section><div class=section-header><h3 class=section-title>Import / Export</h3></div><div class=btn-group><button class="btn btn-secondary">Export JSON</button><div class=file-input-wrapper><button class="btn btn-secondary">Import JSON</button><input type=file accept=.json>'),lt=n("<option>"),Qt=n('<div class=empty-state><svg viewBox="0 0 24 24"fill=none><path d="M4 19.5A2.5 2.5 0 016.5 17H20"stroke=currentColor stroke-width=2></path><path d="M6.5 2H20v20H6.5A2.5 2.5 0 014 19.5v-15A2.5 2.5 0 016.5 2z"stroke=currentColor stroke-width=2></path></svg><p>'),Wt=n('<div class=glossary-term style=flex-direction:column;align-items:stretch><div class=form-row><div class=form-group><label class=form-label>Source</label><input type=text class=form-input disabled></div><div class=form-group><label class=form-label>Replacement</label><input type=text class=form-input></div></div><div class=form-group><label class=form-label>Description</label><input type=text class=form-input></div><div class=toggle-container style="padding:0.25rem 0"><span class=toggle-label>Case sensitive</span><label class=toggle-switch><input type=checkbox><span class=toggle-slider></span></label></div><div class=btn-group><button class="btn btn-primary btn-sm">Save</button><button class="btn btn-secondary btn-sm">Cancel'),Yt=n('<span class="badge badge-info">Aa'),Xt=n("<span class=glossary-language>"),Zt=n('<div class=glossary-term><span class=glossary-source></span><span class=glossary-arrow>-></span><span class=glossary-target></span><div style=margin-left:auto;display:flex;gap:0.5rem><button class="btn btn-sm btn-ghost">Edit</button><button class="btn btn-sm btn-ghost"style=color:var(--color-red-500)>Delete');const st=[{code:"all",name:"All Languages"},{code:"en",name:"English"},{code:"fi",name:"Finnish"},{code:"de",name:"German"},{code:"fr",name:"French"},{code:"es",name:"Spanish"},{code:"sv",name:"Swedish"}],el=()=>{const[$,C]=o({}),[G,R]=o("all"),[y,I]=o(""),[U,L]=o(!1),[H,E]=o(null),[u,k]=o(null),[x,g]=o(""),[m,z]=o(""),[b,D]=o(!1),[N,A]=o(""),[M,c]=o("all"),[d,s]=o(null),[t,S]=o(""),[Y,Z]=o(!1),[X,ee]=o("");Ge(async()=>{await te()});const te=async()=>{try{const l=await Re.getGlossary();C(l),E(null)}catch(l){E("Failed to load glossary"),console.error("[GlossarySettings] Load error:",l)}},V=l=>{k(l),setTimeout(()=>k(null),3e3)},f=async()=>{const l=x().trim(),r=m().trim();if(!l||!r){E("Source and target terms are required");return}try{const w=N().trim(),p=M(),ie=p!=="all"?`[${p}] ${w}`:w;await Re.addTerm(l,r,b(),ie||void 0),g(""),z(""),D(!1),A(""),c("all"),L(!1),await te(),V("Term added successfully")}catch(w){E("Failed to add term"),console.error("[GlossarySettings] Add error:",w)}},O=(l,r)=>{s(l),S(r.replacement),Z(r.caseSensitive),ee(r.description||"")},he=async()=>{const l=d();if(!l)return;const r=t().trim();if(!r){E("Target term is required");return}try{await Re.addTerm(l,r,Y(),X().trim()||void 0),s(null),await te(),V("Term updated")}catch(w){E("Failed to update term"),console.error("[GlossarySettings] Update error:",w)}},fe=async l=>{if(confirm(`Delete term "${l}"?`))try{await Re.removeTerm(l),await te(),V("Term deleted")}catch(r){E("Failed to delete term"),console.error("[GlossarySettings] Delete error:",r)}},me=async()=>{if(confirm("Delete ALL glossary terms? This cannot be undone."))try{await Re.clearGlossary(),await te(),V("Glossary cleared")}catch(l){E("Failed to clear glossary"),console.error("[GlossarySettings] Clear error:",l)}},T=async()=>{try{const l=await Re.exportGlossary(),r=new Blob([l],{type:"application/json"}),w=URL.createObjectURL(r),p=document.createElement("a");p.href=w,p.download="translate-glossary.json",p.click(),URL.revokeObjectURL(w),V("Glossary exported")}catch(l){E("Failed to export glossary"),console.error("[GlossarySettings] Export error:",l)}},K=async l=>{const r=l.target,w=r.files?.[0];if(w)try{const p=await w.text(),ie=await Re.importGlossary(p);await te(),V(`Imported ${ie} terms`),r.value=""}catch(p){E("Failed to import: "+(p instanceof Error?p.message:"Invalid file")),console.error("[GlossarySettings] Import error:",p)}},_e=l=>{if(!l)return"all";const r=l.match(/^\[([a-z]{2})\]/);return r?r[1]:"all"},B=()=>{const l=G(),r=y().toLowerCase();return Object.entries($()).filter(([w,p])=>{if(l!=="all"){const ie=_e(p.description);if(ie!=="all"&&ie!==l)return!1}return r?w.toLowerCase().includes(r)||p.replacement.toLowerCase().includes(r)||p.description?.toLowerCase().includes(r):!0})};return(()=>{var l=Jt(),r=l.firstChild,w=r.nextSibling,p=w.nextSibling,ie=p.firstChild,Pe=ie.firstChild,De=Pe.firstChild,Fe=Pe.nextSibling,Be=Fe.nextSibling,ye=p.nextSibling,Ke=ye.firstChild,Ie=Ke.firstChild,qe=Ie.firstChild,Ne=qe.nextSibling;Ne.nextSibling;var He=ye.nextSibling,Ve=He.firstChild,je=Ve.nextSibling,q=je.firstChild,re=q.nextSibling,oe=re.firstChild,Se=oe.nextSibling;return e(l,a(v,{get when(){return H()},get children(){var _=Kt();return e(_,H),_}}),p),e(l,a(v,{get when(){return u()},get children(){var _=qt();return e(_,u),_}}),p),De.$$input=_=>I(_.currentTarget.value),Fe.addEventListener("change",_=>R(_.currentTarget.value)),e(Fe,a(W,{each:st,children:_=>(()=>{var j=lt();return e(j,()=>_.name),i(()=>j.value=_.code),j})()})),Be.$$click=()=>L(!U()),e(Be,()=>U()?"Cancel":"+ Add Term"),e(l,a(v,{get when(){return U()},get children(){var _=Ht(),j=_.firstChild,J=j.nextSibling,le=J.firstChild,se=le.firstChild,ne=se.nextSibling,Q=le.nextSibling,ae=Q.firstChild,ce=ae.nextSibling,de=J.nextSibling,pe=de.firstChild,ve=pe.firstChild,ue=ve.nextSibling,we=pe.nextSibling,xe=we.firstChild,$e=xe.nextSibling,Ce=de.nextSibling,ke=Ce.firstChild,be=ke.nextSibling,Te=be.firstChild,ge=Ce.nextSibling,P=ge.firstChild,h=P.nextSibling;return ne.$$input=F=>g(F.currentTarget.value),ce.$$input=F=>z(F.currentTarget.value),ue.addEventListener("change",F=>c(F.currentTarget.value)),e(ue,a(W,{each:st,children:F=>(()=>{var Je=lt();return e(Je,()=>F.name),i(()=>Je.value=F.code),Je})()})),$e.$$input=F=>A(F.currentTarget.value),Te.addEventListener("change",F=>D(F.currentTarget.checked)),P.$$click=f,h.$$click=()=>L(!1),i(()=>ne.value=x()),i(()=>ce.value=m()),i(()=>ue.value=M()),i(()=>$e.value=N()),i(()=>Te.checked=b()),_}}),ye),e(Ie,()=>B().length,Ne),e(ye,a(v,{get when(){return B().length>0},get fallback(){return(()=>{var _=Qt(),j=_.firstChild,J=j.nextSibling;return e(J,()=>y()?"No matching terms found":"No glossary terms defined yet"),_})()},get children(){return a(W,{get each(){return B()},children:([_,j])=>a(v,{get when(){return d()===_},get fallback(){return(()=>{var J=Zt(),le=J.firstChild,se=le.nextSibling,ne=se.nextSibling,Q=ne.nextSibling,ae=Q.firstChild,ce=ae.nextSibling;return e(le,_),e(ne,()=>j.replacement),e(J,a(v,{get when(){return j.caseSensitive},get children(){return Yt()}}),Q),e(J,a(v,{get when(){return _e(j.description)!=="all"},get children(){var de=Xt();return e(de,()=>_e(j.description)),de}}),Q),ae.$$click=()=>O(_,j),ce.$$click=()=>fe(_),J})()},get children(){var J=Wt(),le=J.firstChild,se=le.firstChild,ne=se.firstChild,Q=ne.nextSibling,ae=se.nextSibling,ce=ae.firstChild,de=ce.nextSibling,pe=le.nextSibling,ve=pe.firstChild,ue=ve.nextSibling,we=pe.nextSibling,xe=we.firstChild,$e=xe.nextSibling,Ce=$e.firstChild,ke=we.nextSibling,be=ke.firstChild,Te=be.nextSibling;return Q.value=_,de.$$input=ge=>S(ge.currentTarget.value),ue.$$input=ge=>ee(ge.currentTarget.value),Ce.addEventListener("change",ge=>Z(ge.currentTarget.checked)),be.$$click=he,Te.$$click=()=>s(null),i(()=>de.value=t()),i(()=>ue.value=X()),i(()=>Ce.checked=Y()),J}})})}}),null),q.$$click=T,Se.addEventListener("change",K),e(je,a(v,{get when(){return Object.keys($()).length>0},get children(){var _=Vt();return _.$$click=me,_}}),null),i(()=>De.value=y()),i(()=>Fe.value=G()),l})()};ze(["input","click"]);var tl=n('<div class="alert alert-error">'),ll=n('<div class="alert alert-success">'),sl=n('<section class=settings-section><h3 class=section-title style=margin-bottom:1rem>Add Site Rule</h3><div class=form-group><label class=form-label>Domain Pattern</label><input type=text class=form-input placeholder="example.com or *.example.com"><p class=form-hint>Use *.domain.com to match all subdomains</p></div><div class=toggle-container><div class=toggle-info><span class=toggle-label>Auto-translate</span><p class=toggle-description>Automatically translate pages on this site</p></div><label class=toggle-switch><input type=checkbox><span class=toggle-slider></span></label></div><div class=form-row><div class=form-group><label class=form-label>Provider</label><select class=form-select></select></div><div class=form-group><label class=form-label>Strategy</label><select class=form-select></select></div></div><div class=form-row><div class=form-group><label class=form-label>Source Language</label><select class=form-select></select></div><div class=form-group><label class=form-label>Target Language</label><select class=form-select></select></div></div><div class=btn-group style=margin-top:1rem><button class="btn btn-primary">Add Rule</button><button class="btn btn-secondary">Cancel'),nl=n('<div><h2 class=section-title style=margin-bottom:0.5rem>Site Rules</h2><p class=section-description>Configure translation settings for specific websites. Rules can include wildcard patterns (e.g., *.example.com) to match multiple subdomains.</p><section class=settings-section><div style=display:flex;justify-content:space-between;align-items:center><span style=color:var(--color-gray-600)> site <!> configured</span><button class="btn btn-primary"></button></div></section><section class=settings-section><div class=section-header><h3 class=section-title>Site Rules</h3></div></section><section class=settings-section><div class=section-header><h3 class=section-title>Import / Export</h3></div><div class=btn-group><button class="btn btn-secondary">Export JSON</button><div class=file-input-wrapper><button class="btn btn-secondary">Import JSON</button><input type=file accept=.json>'),Ae=n("<option>"),al=n('<div class=empty-state><svg viewBox="0 0 24 24"fill=none><circle cx=12 cy=12 r=10 stroke=currentColor stroke-width=2></circle><path d="M2 12h20M12 2a15.3 15.3 0 014 10 15.3 15.3 0 01-4 10 15.3 15.3 0 01-4-10 15.3 15.3 0 014-10z"stroke=currentColor stroke-width=2></path></svg><p>No site rules configured</p><p style=font-size:0.875rem>Add rules to customize translation behavior for specific websites.'),rl=n('<div class=site-rule style=flex-direction:column;align-items:stretch;padding:1rem><div style=font-weight:600;margin-bottom:1rem></div><div class=toggle-container style="padding:0.25rem 0"><span class=toggle-label>Auto-translate</span><label class=toggle-switch><input type=checkbox><span class=toggle-slider></span></label></div><div class=form-row><div class=form-group><label class=form-label>Provider</label><select class=form-select></select></div><div class=form-group><label class=form-label>Strategy</label><select class=form-select></select></div></div><div class=form-row><div class=form-group><label class=form-label>Source Language</label><select class=form-select></select></div><div class=form-group><label class=form-label>Target Language</label><select class=form-select></select></div></div><div class=btn-group style=margin-top:0.5rem><button class="btn btn-primary btn-sm">Save</button><button class="btn btn-secondary btn-sm">Cancel'),il=n("<span>"),ol=n("<span>-> "),cl=n('<div class=site-rule><div style=flex:1><div class=site-domain></div><div class=site-settings><span></span></div></div><div class=btn-group><button class="btn btn-sm btn-ghost">Edit</button><button class="btn btn-sm btn-ghost"style=color:var(--color-red-500)>Delete');const Oe=[{code:"",name:"Use default"},{code:"auto",name:"Auto Detect"},{code:"en",name:"English"},{code:"fi",name:"Finnish"},{code:"de",name:"German"},{code:"fr",name:"French"},{code:"es",name:"Spanish"},{code:"sv",name:"Swedish"}],We=[{id:"",name:"Use default"},{id:"opus-mt",name:"OPUS-MT (Local)"},{id:"translategemma",name:"TranslateGemma (Local)"},{id:"chrome-builtin",name:"Chrome Built-in"},{id:"deepl",name:"DeepL"},{id:"openai",name:"OpenAI"},{id:"google-cloud",name:"Google Cloud"},{id:"anthropic",name:"Claude"}],nt=[{id:"",name:"Use default"},{id:"smart",name:"Smart"},{id:"fast",name:"Fast"},{id:"quality",name:"Quality"},{id:"cost",name:"Cost"},{id:"balanced",name:"Balanced"}],dl=()=>{const[$,C]=o({}),[G,R]=o(!1),[y,I]=o(null),[U,L]=o(null),[H,E]=o(null),[u,k]=o(""),[x,g]=o(!0),[m,z]=o(""),[b,D]=o(""),[N,A]=o(""),[M,c]=o(""),[d,s]=o(!0),[t,S]=o(""),[Y,Z]=o(""),[X,ee]=o(""),[te,V]=o("");Ge(async()=>{await f()});const f=async()=>{try{const l=await Ue.getAllRules();C(l),L(null)}catch(l){L("Failed to load site rules"),console.error("[SiteRulesSettings] Load error:",l)}},O=l=>{E(l),setTimeout(()=>E(null),3e3)},he=async()=>{const l=u().trim().toLowerCase();if(!l){L("Domain pattern is required");return}if(!l.match(/^(\*\.)?[a-z0-9]([a-z0-9-]*[a-z0-9])?(\.[a-z]{2,})+$/)){L("Invalid domain pattern. Examples: example.com, *.example.com");return}try{const r={autoTranslate:x(),preferredProvider:m()||void 0,sourceLang:b()||void 0,targetLang:N()||void 0,strategy:M()||void 0};await Ue.setRules(l,r),k(""),g(!0),z(""),D(""),A(""),c(""),R(!1),await f(),O("Site rule added")}catch(r){L("Failed to add rule"),console.error("[SiteRulesSettings] Add error:",r)}},fe=(l,r)=>{I(l),s(r.autoTranslate),S(r.preferredProvider||""),Z(r.sourceLang||""),ee(r.targetLang||""),V(r.strategy||"")},me=async()=>{const l=y();if(l)try{const r={autoTranslate:d(),preferredProvider:t()||void 0,sourceLang:Y()||void 0,targetLang:X()||void 0,strategy:te()||void 0};await Ue.setRules(l,r),I(null),await f(),O("Site rule updated")}catch(r){L("Failed to update rule"),console.error("[SiteRulesSettings] Update error:",r)}},T=async l=>{if(confirm(`Delete rule for "${l}"?`))try{await Ue.clearRules(l),await f(),O("Rule deleted")}catch(r){L("Failed to delete rule"),console.error("[SiteRulesSettings] Delete error:",r)}},K=async()=>{try{const l=await Ue.exportRules(),r=new Blob([l],{type:"application/json"}),w=URL.createObjectURL(r),p=document.createElement("a");p.href=w,p.download="translate-site-rules.json",p.click(),URL.revokeObjectURL(w),O("Rules exported")}catch(l){L("Failed to export rules"),console.error("[SiteRulesSettings] Export error:",l)}},_e=async l=>{const r=l.target,w=r.files?.[0];if(w)try{const p=await w.text(),ie=await Ue.importRules(p);await f(),O(`Imported ${ie} rules`),r.value=""}catch(p){L("Failed to import: "+(p instanceof Error?p.message:"Invalid file")),console.error("[SiteRulesSettings] Import error:",p)}},B=()=>Object.keys($()).length;return(()=>{var l=nl(),r=l.firstChild,w=r.nextSibling,p=w.nextSibling,ie=p.firstChild,Pe=ie.firstChild,De=Pe.firstChild,Fe=De.nextSibling;Fe.nextSibling;var Be=Pe.nextSibling,ye=p.nextSibling;ye.firstChild;var Ke=ye.nextSibling,Ie=Ke.firstChild,qe=Ie.nextSibling,Ne=qe.firstChild,He=Ne.nextSibling,Ve=He.firstChild,je=Ve.nextSibling;return e(l,a(v,{get when(){return U()},get children(){var q=tl();return e(q,U),q}}),p),e(l,a(v,{get when(){return H()},get children(){var q=ll();return e(q,H),q}}),p),e(Pe,B,De),e(Pe,()=>B()===1?"rule":"rules",Fe),Be.$$click=()=>R(!G()),e(Be,()=>G()?"Cancel":"+ Add Site Rule"),e(l,a(v,{get when(){return G()},get children(){var q=sl(),re=q.firstChild,oe=re.nextSibling,Se=oe.firstChild,_=Se.nextSibling,j=oe.nextSibling,J=j.firstChild,le=J.nextSibling,se=le.firstChild,ne=j.nextSibling,Q=ne.firstChild,ae=Q.firstChild,ce=ae.nextSibling,de=Q.nextSibling,pe=de.firstChild,ve=pe.nextSibling,ue=ne.nextSibling,we=ue.firstChild,xe=we.firstChild,$e=xe.nextSibling,Ce=we.nextSibling,ke=Ce.firstChild,be=ke.nextSibling,Te=ue.nextSibling,ge=Te.firstChild,P=ge.nextSibling;return _.$$input=h=>k(h.currentTarget.value),se.addEventListener("change",h=>g(h.currentTarget.checked)),ce.addEventListener("change",h=>z(h.currentTarget.value)),e(ce,a(W,{each:We,children:h=>(()=>{var F=Ae();return e(F,()=>h.name),i(()=>F.value=h.id),F})()})),ve.addEventListener("change",h=>c(h.currentTarget.value)),e(ve,a(W,{each:nt,children:h=>(()=>{var F=Ae();return e(F,()=>h.name),i(()=>F.value=h.id),F})()})),$e.addEventListener("change",h=>D(h.currentTarget.value)),e($e,a(W,{each:Oe,children:h=>(()=>{var F=Ae();return e(F,()=>h.name),i(()=>F.value=h.code),F})()})),be.addEventListener("change",h=>A(h.currentTarget.value)),e(be,a(W,{get each(){return Oe.filter(h=>h.code!=="auto")},children:h=>(()=>{var F=Ae();return e(F,()=>h.name),i(()=>F.value=h.code),F})()})),ge.$$click=he,P.$$click=()=>R(!1),i(()=>_.value=u()),i(()=>se.checked=x()),i(()=>ce.value=m()),i(()=>ve.value=M()),i(()=>$e.value=b()),i(()=>be.value=N()),q}}),ye),e(ye,a(v,{get when(){return B()>0},get fallback(){return(()=>{var q=al(),re=q.firstChild,oe=re.nextSibling;return oe.nextSibling,q})()},get children(){return a(W,{get each(){return Object.entries($())},children:([q,re])=>a(v,{get when(){return y()===q},get fallback(){return(()=>{var oe=cl(),Se=oe.firstChild,_=Se.firstChild,j=_.nextSibling,J=j.firstChild,le=Se.nextSibling,se=le.firstChild,ne=se.nextSibling;return e(_,q),e(J,()=>re.autoTranslate?"Auto":"Manual"),e(j,a(v,{get when(){return re.preferredProvider},get children(){var Q=il();return e(Q,()=>We.find(ae=>ae.id===re.preferredProvider)?.name),Q}}),null),e(j,a(v,{get when(){return re.targetLang},get children(){var Q=ol();return Q.firstChild,e(Q,()=>re.targetLang,null),Q}}),null),se.$$click=()=>fe(q,re),ne.$$click=()=>T(q),i(()=>Ee(J,`badge ${re.autoTranslate?"badge-success":"badge-neutral"}`)),oe})()},get children(){var oe=rl(),Se=oe.firstChild,_=Se.nextSibling,j=_.firstChild,J=j.nextSibling,le=J.firstChild,se=_.nextSibling,ne=se.firstChild,Q=ne.firstChild,ae=Q.nextSibling,ce=ne.nextSibling,de=ce.firstChild,pe=de.nextSibling,ve=se.nextSibling,ue=ve.firstChild,we=ue.firstChild,xe=we.nextSibling,$e=ue.nextSibling,Ce=$e.firstChild,ke=Ce.nextSibling,be=ve.nextSibling,Te=be.firstChild,ge=Te.nextSibling;return e(Se,q),le.addEventListener("change",P=>s(P.currentTarget.checked)),ae.addEventListener("change",P=>S(P.currentTarget.value)),e(ae,a(W,{each:We,children:P=>(()=>{var h=Ae();return e(h,()=>P.name),i(()=>h.value=P.id),h})()})),pe.addEventListener("change",P=>V(P.currentTarget.value)),e(pe,a(W,{each:nt,children:P=>(()=>{var h=Ae();return e(h,()=>P.name),i(()=>h.value=P.id),h})()})),xe.addEventListener("change",P=>Z(P.currentTarget.value)),e(xe,a(W,{each:Oe,children:P=>(()=>{var h=Ae();return e(h,()=>P.name),i(()=>h.value=P.code),h})()})),ke.addEventListener("change",P=>ee(P.currentTarget.value)),e(ke,a(W,{get each(){return Oe.filter(P=>P.code!=="auto")},children:P=>(()=>{var h=Ae();return e(h,()=>P.name),i(()=>h.value=P.code),h})()})),Te.$$click=me,ge.$$click=()=>I(null),i(()=>le.checked=d()),i(()=>ae.value=t()),i(()=>pe.value=te()),i(()=>xe.value=Y()),i(()=>ke.value=X()),oe}})})}}),null),Ne.$$click=K,je.addEventListener("change",_e),l})()};ze(["click","input"]);var ul=n('<div class="alert alert-error">'),gl=n('<div class="alert alert-success">'),hl=n("<div class=settings-section><div class=loading style=height:100px><span class=spinner>"),ml=n("<div class=cache-stats><div class=stat-card><div class=stat-value></div><div class=stat-label>Cached Entries</div></div><div class=stat-card><div class=stat-value></div><div class=stat-label>Storage Used</div></div><div class=stat-card><div class=stat-value></div><div class=stat-label>Hit Rate"),pl=n("<section class=settings-section><div class=section-header><div><h3 class=section-title>Storage Usage</h3><p class=section-subtitle>Cache storage allocation and usage</p></div></div><div style=margin-bottom:1rem><div style=display:flex;justify-content:space-between;margin-bottom:0.5rem><span style=font-weight:500></span><span style=color:var(--color-gray-500)>of <!> maximum</span></div><div class=progress-bar><div></div></div></div><div style=display:flex;justify-content:space-between;font-size:0.875rem;color:var(--color-gray-600)><div><strong>Oldest entry:</strong> </div><div><strong>Newest entry:</strong> "),vl=n('<div class="alert alert-info"style=margin-top:1rem>Your cache hit rate of <!> means <!> of translations are served from cache, saving API calls and improving response time.'),$l=n('<section class=settings-section><div class=section-header><div><h3 class=section-title>Performance</h3><p class=section-subtitle>Cache hit and miss statistics</p></div></div><div style="display:grid;grid-template-columns:repeat(3, 1fr);gap:1rem"><div><div style=font-size:1.25rem;font-weight:600;color:var(--color-green-600)></div><div style=font-size:0.75rem;color:var(--color-gray-500)>Cache Hits</div></div><div><div style=font-size:1.25rem;font-weight:600;color:var(--color-gray-600)></div><div style=font-size:0.75rem;color:var(--color-gray-500)>Cache Misses</div></div><div><div style=font-size:1.25rem;font-weight:600;color:var(--color-primary-600)></div><div style=font-size:0.75rem;color:var(--color-gray-500)>Total Lookups'),bl=n('<section class=settings-section><div class=section-header><div><h3 class=section-title>Clear Cache</h3><p class=section-subtitle>Remove all cached translations</p></div></div><p style=font-size:0.875rem;color:var(--color-gray-600);margin-bottom:1rem>Clearing the cache will remove all stored translations. Future translations will need to be fetched again, which may result in increased API usage.</p><div class=btn-group><button class="btn btn-danger"></button><button class="btn btn-secondary">Refresh Stats'),fl=n("<section class=settings-section><div class=section-header><h3 class=section-title>How Caching Works</h3></div><div style=font-size:0.875rem;color:var(--color-gray-600)><p style=margin-bottom:0.75rem><strong>LRU Eviction:</strong> When the cache reaches its size limit, the least recently used entries are automatically removed to make room for new translations.</p><p style=margin-bottom:0.75rem><strong>Cache Keys:</strong> Translations are cached based on the source text, source language, target language, and provider. The same text translated with different settings will have separate cache entries.</p><p><strong>Persistence:</strong> The cache is stored in IndexedDB and persists across browser restarts. It is not synced across devices."),_l=n("<div><h2 class=section-title style=margin-bottom:0.5rem>Translation Cache</h2><p class=section-description>Translations are cached locally to improve performance and reduce API calls. The cache uses IndexedDB with LRU (Least Recently Used) eviction when full."),yl=n("<span class=spinner>");function Ye($){if($===0)return"0 B";const C=1024,G=["B","KB","MB","GB"],R=Math.floor(Math.log($)/Math.log(C));return parseFloat(($/Math.pow(C,R)).toFixed(1))+" "+G[R]}function Xe($){return($*100).toFixed(1)+"%"}function at($){return $?new Date($).toLocaleDateString(void 0,{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"N/A"}const Sl=()=>{const[$,C]=o(!0),[G,R]=o(!1),[y,I]=o(null),[U,L]=o(null),[H,E]=o(null);Ge(async()=>{await u()});const u=async()=>{C(!0);try{const m=await chrome.runtime.sendMessage({type:"getCacheStats"});if(m?.stats)I(m.stats);else{const z=await navigator.storage?.estimate?.()||{usage:0,quota:0};I({entries:0,totalSize:z.usage||0,maxSize:100*1024*1024,hits:0,misses:0,hitRate:0,oldestTimestamp:null,newestTimestamp:null})}}catch(m){console.error("[CacheSettings] Failed to load stats:",m),L("Failed to load cache statistics")}finally{C(!1)}},k=m=>{E(m),setTimeout(()=>E(null),3e3)},x=async()=>{if(confirm("Clear all cached translations? This cannot be undone.")){R(!0),L(null);try{await chrome.runtime.sendMessage({type:"clearCache"}),await u(),k("Cache cleared successfully")}catch(m){console.error("[CacheSettings] Failed to clear cache:",m),L("Failed to clear cache")}finally{R(!1)}}},g=()=>{const m=y();return!m||m.maxSize===0?0:Math.min(100,m.totalSize/m.maxSize*100)};return(()=>{var m=_l(),z=m.firstChild;return z.nextSibling,e(m,a(v,{get when(){return U()},get children(){var b=ul();return e(b,U),b}}),null),e(m,a(v,{get when(){return H()},get children(){var b=gl();return e(b,H),b}}),null),e(m,a(v,{get when(){return $()},get children(){var b=hl();return b.firstChild,b}}),null),e(m,a(v,{get when(){return Me(()=>!$())()&&y()},get children(){return[(()=>{var b=ml(),D=b.firstChild,N=D.firstChild,A=D.nextSibling,M=A.firstChild,c=A.nextSibling,d=c.firstChild;return e(N,()=>y().entries.toLocaleString()),e(M,()=>Ye(y().totalSize)),e(d,()=>Xe(y().hitRate)),b})(),(()=>{var b=pl(),D=b.firstChild,N=D.nextSibling,A=N.firstChild,M=A.firstChild,c=M.nextSibling,d=c.firstChild,s=d.nextSibling;s.nextSibling;var t=A.nextSibling,S=t.firstChild,Y=N.nextSibling,Z=Y.firstChild,X=Z.firstChild;X.nextSibling;var ee=Z.nextSibling,te=ee.firstChild;return te.nextSibling,e(M,()=>Ye(y().totalSize)),e(c,()=>Ye(y().maxSize),s),e(Z,()=>at(y().oldestTimestamp),null),e(ee,()=>at(y().newestTimestamp),null),i(V=>{var f=`progress-fill ${g()>80?"danger":g()>50?"warning":""}`,O=`${g()}%`;return f!==V.e&&Ee(S,V.e=f),O!==V.t&&ot(S,"width",V.t=O),V},{e:void 0,t:void 0}),b})(),(()=>{var b=$l(),D=b.firstChild,N=D.nextSibling,A=N.firstChild,M=A.firstChild;M.nextSibling;var c=A.nextSibling,d=c.firstChild;d.nextSibling;var s=c.nextSibling,t=s.firstChild;return t.nextSibling,e(M,()=>y().hits.toLocaleString()),e(d,()=>y().misses.toLocaleString()),e(t,()=>(y().hits+y().misses).toLocaleString()),e(b,a(v,{get when(){return y().hitRate>0},get children(){var S=vl(),Y=S.firstChild,Z=Y.nextSibling,X=Z.nextSibling,ee=X.nextSibling;return ee.nextSibling,e(S,()=>Xe(y().hitRate),Z),e(S,()=>Xe(y().hitRate),ee),S}}),null),b})(),(()=>{var b=bl(),D=b.firstChild,N=D.nextSibling,A=N.nextSibling,M=A.firstChild,c=M.nextSibling;return M.$$click=x,e(M,(()=>{var d=Me(()=>!!G());return()=>d()?[yl(),"Clearing..."]:"Clear Cache"})()),c.$$click=u,i(()=>M.disabled=G()||y().entries===0),b})(),(()=>{var b=fl(),D=b.firstChild,N=D.nextSibling,A=N.firstChild;return A.nextSibling,b})()]}}),null),m})()};ze(["click"]);var wl=n('<svg width=18 height=18 viewBox="0 0 24 24"fill=none><circle cx=12 cy=12 r=3 stroke=currentColor stroke-width=2></circle><path d="M19.4 15a1.65 1.65 0 00.33 1.82l.06.06a2 2 0 010 2.83 2 2 0 01-2.83 0l-.06-.06a1.65 1.65 0 00-1.82-.33 1.65 1.65 0 00-1 1.51V21a2 2 0 01-2 2 2 2 0 01-2-2v-.09A1.65 1.65 0 009 19.4a1.65 1.65 0 00-1.82.33l-.06.06a2 2 0 01-2.83 0 2 2 0 010-2.83l.06-.06a1.65 1.65 0 00.33-1.82 1.65 1.65 0 00-1.51-1H3a2 2 0 01-2-2 2 2 0 012-2h.09A1.65 1.65 0 004.6 9a1.65 1.65 0 00-.33-1.82l-.06-.06a2 2 0 010-2.83 2 2 0 012.83 0l.06.06a1.65 1.65 0 001.82.33H9a1.65 1.65 0 001-1.51V3a2 2 0 012-2 2 2 0 012 2v.09a1.65 1.65 0 001 1.51 1.65 1.65 0 001.82-.33l.06-.06a2 2 0 012.83 0 2 2 0 010 2.83l-.06.06a1.65 1.65 0 00-.33 1.82V9a1.65 1.65 0 001.51 1H21a2 2 0 012 2 2 2 0 01-2 2h-.09a1.65 1.65 0 00-1.51 1z"stroke=currentColor stroke-width=2>'),xl=n('<svg width=18 height=18 viewBox="0 0 24 24"fill=none><path d="M18 10h-1.26A8 8 0 109 20h9a5 5 0 000-10z"stroke=currentColor stroke-width=2 stroke-linecap=round stroke-linejoin=round>'),Cl=n('<svg width=18 height=18 viewBox="0 0 24 24"fill=none><rect x=4 y=4 width=16 height=16 rx=2 stroke=currentColor stroke-width=2></rect><rect x=9 y=9 width=6 height=6 stroke=currentColor stroke-width=2></rect><path d="M9 1v3M15 1v3M9 20v3M15 20v3M20 9h3M20 15h3M1 9h3M1 15h3"stroke=currentColor stroke-width=2>'),kl=n('<svg width=18 height=18 viewBox="0 0 24 24"fill=none><path d="M4 19.5A2.5 2.5 0 016.5 17H20"stroke=currentColor stroke-width=2 stroke-linecap=round stroke-linejoin=round></path><path d="M6.5 2H20v20H6.5A2.5 2.5 0 014 19.5v-15A2.5 2.5 0 016.5 2z"stroke=currentColor stroke-width=2 stroke-linecap=round stroke-linejoin=round>'),Tl=n('<svg width=18 height=18 viewBox="0 0 24 24"fill=none><circle cx=12 cy=12 r=10 stroke=currentColor stroke-width=2></circle><path d="M2 12h20M12 2a15.3 15.3 0 014 10 15.3 15.3 0 01-4 10 15.3 15.3 0 01-4-10 15.3 15.3 0 014-10z"stroke=currentColor stroke-width=2>'),Ll=n('<svg width=18 height=18 viewBox="0 0 24 24"fill=none><ellipse cx=12 cy=5 rx=9 ry=3 stroke=currentColor stroke-width=2></ellipse><path d="M21 12c0 1.66-4 3-9 3s-9-1.34-9-3"stroke=currentColor stroke-width=2></path><path d="M3 5v14c0 1.66 4 3 9 3s9-1.34 9-3V5"stroke=currentColor stroke-width=2>'),Al=n('<div class=options-container><header class=options-header><div class=header-brand><svg width=32 height=32 viewBox="0 0 24 24"fill=none class=brand-logo><path d="M3 5h12M9 3v2m1.048 3.5A3.5 3.5 0 016.5 12a3.5 3.5 0 01-2.45-5.943M6 16l-2 6 3-2 3 2-2-6M21 21l-6-6m6 0l-6 6M15 15l6-6m-6 0l6 6"stroke=currentColor stroke-width=2 stroke-linecap=round stroke-linejoin=round></path></svg><div class=brand-text><h1>TRANSLATE! Settings</h1><span class=brand-subtitle>Configure your translation preferences</span></div></div></header><div class=options-content><nav class=options-nav></nav><main class=options-main></main></div><footer class=options-footer><span>TRANSLATE! v2.0 by Mikko</span><span class=footer-divider>|</span><a href=https://github.com/your-repo target=_blank rel="noopener noreferrer">Documentation'),El=n("<button><span>"),Ml=n("<div class=loading>Loading...");const rt=[{id:"general",label:"General",icon:"settings"},{id:"cloud",label:"Cloud Providers",icon:"cloud"},{id:"local",label:"Local Models",icon:"cpu"},{id:"glossary",label:"Glossary",icon:"book"},{id:"sites",label:"Site Rules",icon:"globe"},{id:"cache",label:"Cache",icon:"database"}];function Pl(){const[$,C]=o("general"),[G,R]=o(!0);Ge(()=>{const U=new URLSearchParams(window.location.search).get("tab");U&&rt.some(L=>L.id===U)&&C(U),R(!1)});const y=I=>{switch(I){case"settings":return wl();case"cloud":return xl();case"cpu":return Cl();case"book":return kl();case"globe":return Tl();case"database":return Ll();default:return null}};return(()=>{var I=Al(),U=I.firstChild,L=U.nextSibling,H=L.firstChild,E=H.nextSibling;return e(H,a(W,{each:rt,children:u=>(()=>{var k=El(),x=k.firstChild;return k.$$click=()=>C(u.id),e(k,()=>y(u.icon),x),e(x,()=>u.label),i(()=>Ee(k,`nav-item ${$()===u.id?"active":""}`)),k})()})),e(E,a(v,{get when(){return!G()},get fallback(){return Ml()},get children(){return[a(v,{get when(){return $()==="general"},get children(){return a(vt,{})}}),a(v,{get when(){return $()==="cloud"},get children(){return a(Ft,{})}}),a(v,{get when(){return $()==="local"},get children(){return a(Ot,{})}}),a(v,{get when(){return $()==="glossary"},get children(){return a(el,{})}}),a(v,{get when(){return $()==="sites"},get children(){return a(dl,{})}}),a(v,{get when(){return $()==="cache"},get children(){return a(Sl,{})}})]}})),I})()}ze(["click"]);const it=document.getElementById("root");it&&ct(()=>a(Pl,{}),it);
//# sourceMappingURL=options-C5_aADBV.js.map
