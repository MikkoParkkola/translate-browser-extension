{"version":3,"file":"storage--5bP51BW.js","sources":["../../src/core/logger.ts","../../src/core/browser-api.ts","../../src/core/storage.ts"],"sourcesContent":["/**\n * Simple logging utility with module prefixing\n */\n\nexport function createLogger(module: string) {\n  return {\n    debug: (msg: string, ...args: unknown[]) => console.log(`[${module}]`, msg, ...args),\n    info: (msg: string, ...args: unknown[]) => console.log(`[${module}]`, msg, ...args),\n    warn: (msg: string, ...args: unknown[]) => console.warn(`[${module}]`, msg, ...args),\n    error: (msg: string, ...args: unknown[]) => console.error(`[${module}]`, msg, ...args),\n  };\n}\n","/**\n * Browser API Compatibility Layer\n *\n * Provides a unified API that works across Chrome, Firefox, and Edge.\n * Firefox uses the Promise-based browser.* API natively.\n * Chrome uses the callback-based chrome.* API (with Promise wrappers in newer versions).\n *\n * This module exports a `browserAPI` object that normalizes these differences.\n */\n\n// Type declaration for browser.* (Firefox WebExtension API)\ndeclare const browser: typeof chrome | undefined;\n\n/**\n * Get the appropriate browser API object.\n * Firefox exposes `browser`, Chrome/Edge expose `chrome`.\n * Modern Chrome also supports `chrome` with Promises, so we prefer `browser` if available\n * as it's guaranteed to be Promise-based.\n */\nexport const browserAPI: typeof chrome =\n  typeof browser !== 'undefined' ? browser : chrome;\n\n/**\n * Check if running in Firefox\n */\nexport function isFirefox(): boolean {\n  return typeof browser !== 'undefined' && navigator.userAgent.includes('Firefox');\n}\n\n/**\n * Check if running in Chrome/Chromium\n */\nexport function isChrome(): boolean {\n  return typeof chrome !== 'undefined' && !isFirefox();\n}\n\n/**\n * Get extension URL for a resource\n */\nexport function getURL(path: string): string {\n  return browserAPI.runtime.getURL(path);\n}\n\n/**\n * Send a message to the background script\n */\nexport function sendMessage<T = unknown>(message: unknown): Promise<T> {\n  return browserAPI.runtime.sendMessage(message);\n}\n\n/**\n * Listen for messages\n */\nexport function onMessage(\n  callback: (\n    message: unknown,\n    sender: chrome.runtime.MessageSender,\n    sendResponse: (response?: unknown) => void\n  ) => boolean | void | Promise<unknown>\n): void {\n  browserAPI.runtime.onMessage.addListener(callback);\n}\n\n/**\n * Storage API wrappers (local storage)\n */\nexport const storage = {\n  async get<T = Record<string, unknown>>(keys: string | string[]): Promise<T> {\n    return browserAPI.storage.local.get(keys) as Promise<T>;\n  },\n\n  async set(items: Record<string, unknown>): Promise<void> {\n    return browserAPI.storage.local.set(items);\n  },\n\n  async remove(keys: string | string[]): Promise<void> {\n    return browserAPI.storage.local.remove(keys);\n  },\n\n  async clear(): Promise<void> {\n    return browserAPI.storage.local.clear();\n  },\n};\n\n/**\n * Get the current platform (for debugging)\n */\nexport function getPlatform(): 'firefox' | 'chrome' | 'edge' | 'unknown' {\n  const ua = navigator.userAgent;\n  if (ua.includes('Firefox')) return 'firefox';\n  if (ua.includes('Edg/')) return 'edge';\n  if (ua.includes('Chrome')) return 'chrome';\n  return 'unknown';\n}\n","import { createLogger } from './logger';\nimport { browserAPI } from './browser-api';\n\nconst log = createLogger('Storage');\n\nexport async function safeStorageGet<T>(keys: string | string[]): Promise<Partial<T>> {\n  try {\n    return await browserAPI.storage.local.get(keys) as Partial<T>;\n  } catch (error) {\n    log.warn('Storage get failed:', error);\n    return {};\n  }\n}\n\nexport async function safeStorageSet(items: Record<string, unknown>): Promise<boolean> {\n  try {\n    await browserAPI.storage.local.set(items);\n    return true;\n  } catch (error) {\n    log.warn('Storage set failed:', error);\n    return false;\n  }\n}\n"],"names":["createLogger","module","msg","args","browserAPI","getURL","path","log","safeStorageGet","keys","error","safeStorageSet","items"],"mappings":"AAIO,SAASA,EAAaC,EAAgB,CAC3C,MAAO,CACL,MAAO,CAACC,KAAgBC,IAAoB,QAAQ,IAAI,IAAIF,CAAM,IAAKC,EAAK,GAAGC,CAAI,EACnF,KAAM,CAACD,KAAgBC,IAAoB,QAAQ,IAAI,IAAIF,CAAM,IAAKC,EAAK,GAAGC,CAAI,EAClF,KAAM,CAACD,KAAgBC,IAAoB,QAAQ,KAAK,IAAIF,CAAM,IAAKC,EAAK,GAAGC,CAAI,EACnF,MAAO,CAACD,KAAgBC,IAAoB,QAAQ,MAAM,IAAIF,CAAM,IAAKC,EAAK,GAAGC,CAAI,CAAA,CAEzF,CCQO,MAAMC,EACX,OAAO,QAAY,IAAc,QAAU,OAmBtC,SAASC,EAAOC,EAAsB,CAC3C,OAAOF,EAAW,QAAQ,OAAOE,CAAI,CACvC,CCtCA,MAAMC,EAAMP,EAAa,SAAS,EAElC,eAAsBQ,EAAkBC,EAA8C,CACpF,GAAI,CACF,OAAO,MAAML,EAAW,QAAQ,MAAM,IAAIK,CAAI,CAChD,OAASC,EAAO,CACd,OAAAH,EAAI,KAAK,sBAAuBG,CAAK,EAC9B,CAAA,CACT,CACF,CAEA,eAAsBC,EAAeC,EAAkD,CACrF,GAAI,CACF,aAAMR,EAAW,QAAQ,MAAM,IAAIQ,CAAK,EACjC,EACT,OAASF,EAAO,CACd,OAAAH,EAAI,KAAK,sBAAuBG,CAAK,EAC9B,EACT,CACF"}